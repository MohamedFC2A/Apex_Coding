(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[191],{678:function(e,t,n){Promise.resolve().then(n.bind(n,8445)),Promise.resolve().then(n.bind(n,9019)),Promise.resolve().then(n.bind(n,2986))},8445:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return rX}});var r=n(7821),i=n(8078),a=n(5290),o=n(2828),s=n(1525),l=n(534),c=n(2348),d=n(3392),p=n(3116),g=n(6135),h=n(3020),u=n(4302);let x={projectId:"",projectName:"",files:[],fileStructure:[],activeFile:null,stack:"",description:"",isHydrating:!1},f=(0,h.Ue)()((0,u.tJ)(e=>({...x,setProjectId:t=>e({projectId:t}),setProjectName:t=>e({projectName:t}),setFiles:t=>e({files:t}),setFileStructure:t=>e({fileStructure:t}),setActiveFile:t=>e({activeFile:t}),setIsHydrating:t=>e({isHydrating:t}),updateFile:(t,n)=>e(e=>({files:e.files.map(e=>e.path===t?{...e,content:n}:e)})),upsertFile:t=>e(e=>{let n=t.path||t.name;return n?e.files.some(e=>(e.path||e.name)===n)?{files:e.files.map(e=>(e.path||e.name)===n?{...e,...t,path:n}:e)}:{files:[...e.files,{...t,path:n}]}:e}),appendToFile:(t,n)=>e(e=>({files:e.files.map(e=>(e.path||e.name)===t?{...e,content:(e.content||"")+n,path:t}:e)})),addFile:t=>e(e=>({files:[...e.files,t]})),deleteFile:t=>e(e=>({files:e.files.filter(e=>e.path!==t),activeFile:e.activeFile===t?null:e.activeFile})),setStack:t=>e({stack:t}),setDescription:t=>e({description:t}),reset:()=>e(x)}),{name:"nexus-project-store",partialize:e=>({projectId:e.projectId,projectName:e.projectName,files:e.files,fileStructure:e.fileStructure,activeFile:e.activeFile,stack:e.stack,description:e.description})}));var m=n(7147);let b="/api",w=e=>"".concat(String(b).replace(/\/+$/,"")).concat(e.startsWith("/")?"":"/").concat(e),v=(e,t)=>(null==e?void 0:e.error)||(null==e?void 0:e.message)||t,y={async generatePlan(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{let n=w("/ai/plan"),r=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e,thinkingMode:t})});if(!r.ok){let e=await r.text().catch(()=>"");throw Error(e||"Plan failed (".concat(r.status,")"))}let i=await r.json();return{steps:Array.isArray(null==i?void 0:i.steps)?i.steps:[]}}catch(e){throw console.error("Plan Error Details:",e),Error(v(e,"Failed to generate plan"))}},async generateCode(e){throw Error("generateCode() is deprecated; use generateCodeStream()")},async generateCodeStream(e,t,n,r,i,a,o,s){let l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];try{var c;let d="boolean"==typeof l?{thinkingMode:l}:l,p=!!d.thinkingMode,g=!!d.architectMode,h=!!d.includeReasoning,u=Number(null!==(c=d.typingMs)&&void 0!==c?c:26),x=Number.isFinite(u)?u:26;r({provider:"vercel-backend",baseURL:b,thinkingMode:p,architectMode:g}),n("streaming","Generating…");let f=e=>{let t=e.split(/\r?\n/),n="message",r=[];for(let e of t)if(!e.startsWith(":")){if(e.startsWith("event:")){n=e.slice(6).trim();continue}if(e.startsWith("data:")){let t=e.slice(5);r.push(t.startsWith(" ")?t.slice(1):t);continue}}let i=r.join("\n");return{eventName:n,dataText:i}},v="[[START_FILE:",y="[[EDIT_FILE:",j="[[EDIT_NODE:",k="[[END_FILE]]",C=new Set,P=new Set,S="",I=0,Z=e=>{let t=0;for(let n=0;n<e.length;n++)10===e.charCodeAt(n)&&t++;return t},E=e=>{let t=(e||"").toLowerCase();return t.endsWith(".html")?"\n<!-- [[PARTIAL_FILE_CLOSED]] -->\n":t.endsWith(".css")?"\n/* [[PARTIAL_FILE_CLOSED]] */\n":t.endsWith(".md")?"\n<!-- [[PARTIAL_FILE_CLOSED]] -->\n":"\n// [[PARTIAL_FILE_CLOSED]]\n"};class T{setResumeAppendPath(e){this.resumeAppendPath=e}push(e){e&&(this.scan+=e,this.drain())}drain(){for(;this.scan.length>0;){var e,t,n;if(!this.inFile){let n=this.scan.indexOf(v),r=this.scan.indexOf(y),i=this.scan.indexOf(j),a=null!==(t=[n,r,i].filter(e=>-1!==e).sort((e,t)=>e-t)[0])&&void 0!==t?t:-1;if(-1===a){let e=Math.max(v.length-1,y.length-1,j.length-1);this.scan=this.scan.slice(Math.max(0,this.scan.length-e));return}let o=-1!==r&&r===a||-1!==i&&i===a,s=n===a?v:o&&i===a?j:y,l=this.scan.indexOf("]]",a);if(-1===l){this.scan=this.scan.slice(a);return}let c=this.scan.slice(a+s.length,l).trim();this.currentPath=c,this.inFile=!0,this.currentLine=1,this.currentMode=o?"edit":"create",this.scan=this.scan.slice(l+2),null===(e=d.onFileEvent)||void 0===e||e.call(d,{type:"start",path:c,mode:this.currentMode,append:!!(this.resumeAppendPath&&c===this.resumeAppendPath),line:1});continue}let r=this.scan.indexOf(k),i=this.scan.indexOf(v),a=this.scan.indexOf(y),o=-1===i?a:-1===a?i:Math.min(i,a);if(-1!==o&&(-1===r||o<r)){this.flushContent(this.scan.slice(0,o)),this.forceClose(!0),this.scan=this.scan.slice(o);continue}if(-1!==r){this.flushContent(this.scan.slice(0,r)),C.add(this.currentPath),null===(n=d.onFileEvent)||void 0===n||n.call(d,{type:"end",path:this.currentPath,mode:this.currentMode,partial:!1,line:this.currentLine}),S=this.currentPath,I=this.currentLine,this.inFile=!1,this.currentPath="",this.scan=this.scan.slice(r+k.length);continue}let s=Math.max(v.length+8,y.length+8,k.length+8);if(this.scan.length<=s)return;this.flushContent(this.scan.slice(0,this.scan.length-s)),this.scan=this.scan.slice(this.scan.length-s)}}flushContent(e){var t;e&&(null===(t=d.onFileEvent)||void 0===t||t.call(d,{type:"chunk",path:this.currentPath,mode:this.currentMode,chunk:e,line:this.currentLine}),this.currentLine+=Z(e))}forceClose(e){var t,n;let r=E(this.currentPath);null===(t=d.onFileEvent)||void 0===t||t.call(d,{type:"chunk",path:this.currentPath,mode:this.currentMode,chunk:r,line:this.currentLine}),this.currentLine+=Z(r),P.add(this.currentPath),null===(n=d.onFileEvent)||void 0===n||n.call(d,{type:"end",path:this.currentPath,mode:this.currentMode,partial:e,line:this.currentLine}),S=this.currentPath,I=this.currentLine,this.inFile=!1,this.currentPath=""}finalize(){if(!this.inFile)return null;this.scan.length>0&&(this.flushContent(this.scan),this.scan="");let e=this.currentPath,t=this.currentLine;return this.forceClose(!0),{cutPath:e,cutLine:t}}constructor(){(0,m._)(this,"scan",""),(0,m._)(this,"inFile",!1),(0,m._)(this,"currentPath",""),(0,m._)(this,"currentLine",1),(0,m._)(this,"currentMode","create"),(0,m._)(this,"resumeAppendPath",void 0)}}class N{enqueue(e){if(!this.closed&&e){if(this.queue+=e,this.tickMs<=0){let e=this.queue;this.queue="",e&&this.onEmit(e);return}this.timer||this.start()}}start(){this.timer=globalThis.setInterval(()=>{if(0===this.queue.length){this.closed&&this.stop();return}let e=this.queue.length,t=e>8e3?140:e>3e3?80:e>1200?40:e>300?16:4,n=this.queue.slice(0,t);this.queue=this.queue.slice(t),this.onEmit(n)},this.tickMs)}close(){this.closed=!0,this.tickMs<=0||0!==this.queue.length||this.stop()}flushAll(){if(this.queue.length>0){let e=this.queue;this.queue="",this.onEmit(e)}this.closed=!0,this.stop()}stop(){this.timer&&(globalThis.clearInterval(this.timer),this.timer=null)}constructor(e,t){(0,m._)(this,"tickMs",void 0),(0,m._)(this,"onEmit",void 0),(0,m._)(this,"timer",void 0),(0,m._)(this,"queue",void 0),(0,m._)(this,"closed",void 0),this.tickMs=e,this.onEmit=t,this.timer=null,this.queue="",this.closed=!1}}let F="",z=async(e,i)=>{let s=await fetch(w("/ai/generate"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify({prompt:e,thinkingMode:p,architectMode:g,includeReasoning:h,history:d.history||[]})});if(!s.ok){let e="Streaming failed (".concat(s.status,")"),t=await s.text().catch(()=>"");throw t&&(e=t),Error(e)}let l=s.body;if(!l)throw Error("Streaming failed: empty response body");let c=l.getReader(),u=new TextDecoder,m="",b=!1,v=!1,y=new T;y.setResumeAppendPath(i);let j=new N(x,e=>{y.push(e),t(e)}),k=e=>{e&&(b=!0,F=(F+e).slice(-2200),j.enqueue(e))};for(;;){let{done:e,value:t}=await c.read();if(e)break;let i=u.decode(t,{stream:!0});if(0===i.length)continue;if(!(/(^|\n)event:\s/.test(i)||/(^|\n)data:\s/.test(i))&&0===m.length){let e=i.replace(/^:[^\n]*\n+/gm,"");e.length>0&&k(e);continue}let s=(m+=i).indexOf("\n\n");for(;-1!==s;){let e=m.slice(0,s);s=(m=m.slice(s+2)).indexOf("\n\n");let{eventName:t,dataText:i}=f(e);if("meta"===t){r({raw:i});continue}if("status"===t){let e=i.indexOf(":"),t=-1===e?"streaming":i.slice(0,e),r=-1===e?i:i.slice(e+1);n(t,r),"done"===t&&(v=!0),"error"===t&&r&&a(r);continue}if("thought"===t&&h){o(i);continue}if("token"===t){k(i);continue}}if(m.length>0&&!/(^|\n)event:\s/.test(m)&&!/(^|\n)data:\s/.test(m)){let e=m.replace(/^:[^\n]*\n+/gm,"");m="",e.length>0&&k(e)}}if(v||n("done","Complete"),j.flushAll(),!b)throw Error("Backend connection failed or timed out");return{markerParser:y}},A=(await z(e)).markerParser.finalize();if(A){n("streaming","Resuming…"),r({resume:{attempt:1,file:A.cutPath,line:A.cutLine}});let t=((t,n)=>{let r=Array.from(C).slice(-80).join(", "),i=F.slice(-2200);return[e,"","SYSTEM: You were cut off mid-stream. Resume using ONLY the File-Marker protocol.","The last file ".concat(t," was cut off at line ").concat(n,". Continue the stream exactly from line ").concat(n+1," (do not repeat earlier lines)."),r?"DO NOT repeat these already completed files: ".concat(r):"",i?"Last received tail (for context, may be truncated):\n".concat(i):"","Output only markers + code. No filler."].filter(Boolean).join("\n")})(A.cutPath,A.cutLine);(await z(t,A.cutPath)).markerParser.finalize()}i({project_files:[],metadata:{protocol:"file-marker",completedFiles:C.size,partialFiles:P.size,lastSuccessfulFile:S,lastSuccessfulLine:I},instructions:""}),s()}catch(e){a((null==e?void 0:e.message)||"Streaming failed"),s()}}},j=new Set(["readme.md"]),k=new Set(["html","css","scss","sass","less","jsx","tsx","vue","svelte"]),C=new Set(["js","ts","py","go","rb","java","cs","php","rs","cpp","c","sql","env"]),P=["frontend","client","components","pages","public","styles","assets","hooks","ui"],S=["backend","server","api","routes","controllers","models","db","database","middleware"],I=new Set(["index.html","main.tsx","main.jsx","app.tsx","app.jsx","vite.config.ts","vite.config.js","tailwind.config.js","tailwind.config.ts","postcss.config.js","postcss.config.cjs","postcss.config.ts"]),Z=new Set(["server.js","server.ts","server.py","app.js","app.ts","app.py","main.py","requirements.txt",".env",".env.example"]),E=()=>[],T=e=>Array.isArray(e)?{}:e,N=e=>{let t={};for(let[n,r]of Object.entries(e))r.file&&(t[n]={file:{contents:r.file.contents}}),r.directory&&(t[n]={...t[n],directory:N(r.directory)});return t},F=e=>e.replace(/\\/g,"/").replace(/^(\.\/)+/,"").replace(/^\/+/,"").trim(),z=e=>j.has(e.toLowerCase()),A=e=>{let t=e.toLowerCase().split("/"),n=t[t.length-1]||"",r=n.includes(".")&&n.split(".").pop()||"",i=t.some(e=>P.includes(e))||P.some(e=>n.includes(e)),a=t.some(e=>S.includes(e))||S.some(e=>n.includes(e));return I.has(n)||r&&k.has(r)||i?"frontend":Z.has(n)||r&&C.has(r)||a?"backend":"frontend"},M=e=>{if(!e)return"";let t=F(e);if(!t)return"";let n=t.toLowerCase();if(n.startsWith("frontend/")||n.startsWith("backend/"))return t;let r=t.split("/"),i=r[r.length-1]||"";if(1===r.length&&z(i))return t;let a=A(t);return"".concat(a,"/").concat(t)},L=e=>{if(!e)return"";let t=F(e).replace(/\/+$/,"");if(!t)return"";let n=t.toLowerCase();if(n.startsWith("frontend/")||n.startsWith("backend/"))return t;let r=A(t);return"".concat(r,"/").concat(t)},R=(e,t,n)=>{let r=M(t);if(!r)return e;let i=r.split("/"),a=(e,t)=>{var r,o,s,l,c;let d=i[t];if(t===i.length-1){let t=null!==(l=null===(s=e[d])||void 0===s?void 0:null===(o=s.file)||void 0===o?void 0:o.contents)&&void 0!==l?l:"";return{...e,[d]:{file:{contents:null!=n?n:t}}}}let p=null!==(c=null===(r=e[d])||void 0===r?void 0:r.directory)&&void 0!==c?c:{};return{...e,[d]:{directory:a(p,t+1)}}};return a(e,0)},$=(e,t)=>{let n=L(t);if(!n)return e;let r=n.split("/"),i=(e,t)=>{var n,a,o,s;let l=r[t];if(t===r.length-1){let t=null!==(o=null===(a=e[l])||void 0===a?void 0:a.directory)&&void 0!==o?o:{};return{...e,[l]:{directory:t}}}let c=null!==(s=null===(n=e[l])||void 0===n?void 0:n.directory)&&void 0!==s?s:{};return{...e,[l]:{directory:i(c,t+1)}}};return i(e,0)},O=(e,t,n)=>{let r=M(t);if(!r)return e;let i=r.split("/"),a=(e,t)=>{var r,o,s,l,c;let d=i[t];if(t===i.length-1){let t=null!==(l=null===(s=e[d])||void 0===s?void 0:null===(o=s.file)||void 0===o?void 0:o.contents)&&void 0!==l?l:"";return{...e,[d]:{file:{contents:t+n}}}}let p=null!==(c=null===(r=e[d])||void 0===r?void 0:r.directory)&&void 0!==c?c:{};return{...e,[d]:{directory:a(p,t+1)}}};return a(e,0)},D=e=>{let t={};for(let n of e){let e=n.path||n.name;e&&(t=R(t,e,n.content||""))}return t},_=()=>({prompt:"",plan:"",planSteps:[],architectMode:!0,lastPlannedPrompt:"",chatHistory:[],decisionTrace:"",streamText:"",lastTokenAt:0,modelMode:"fast",interactionMode:"create",writingFilePath:null,fileStatuses:{},sections:{},isGenerating:!1,isPlanning:!1,thinkingContent:"",systemConsoleContent:"",generationStatus:{isGenerating:!1,currentStep:"idle",progress:0},error:null,isPreviewOpen:!1,files:E(),history:[]}),W=_(),U=(0,h.Ue)()((0,u.tJ)((e,t)=>({...W,setPrompt:t=>e({prompt:t}),setPlan:t=>e({plan:t}),setPlanSteps:t=>e({planSteps:t}),setPlanStepCompleted:(t,n)=>e(e=>({planSteps:e.planSteps.map(e=>e.id===t?{...e,completed:n}:e)})),clearPlanSteps:()=>e({planSteps:[]}),setArchitectMode:t=>e({architectMode:t}),setLastPlannedPrompt:t=>e({lastPlannedPrompt:t}),setChatHistory:t=>e({chatHistory:t}),addChatMessage:t=>e(e=>({chatHistory:[...e.chatHistory,t]})),clearChatHistory:()=>e({chatHistory:[]}),setInteractionMode:t=>e({interactionMode:t}),generatePlan:async n=>{var r;let i=(null!==(r=null!=n?n:t().prompt)&&void 0!==r?r:"").trim();if(i){e({isPlanning:!0,error:null});try{let n="thinking"===t().modelMode,r=await y.generatePlan(i,n),a=(Array.isArray(null==r?void 0:r.steps)?r.steps:[]).map((e,t)=>{var n,r,i,a;return{id:String(null!==(n=null==e?void 0:e.id)&&void 0!==n?n:t+1),title:String(null!==(a=null!==(i=null!==(r=null==e?void 0:e.title)&&void 0!==r?r:null==e?void 0:e.text)&&void 0!==i?i:null==e?void 0:e.step)&&void 0!==a?a:"").trim(),completed:!1}}).filter(e=>e.title.length>0);e({planSteps:a,lastPlannedPrompt:i})}catch(t){e({error:(null==t?void 0:t.message)||"Failed to generate plan"})}finally{e({isPlanning:!1})}}},setDecisionTrace:t=>e({decisionTrace:t}),appendStreamText:t=>e(e=>({streamText:e.streamText+t,lastTokenAt:Date.now()})),setStreamText:t=>e({streamText:t}),updateLastToken:()=>e({lastTokenAt:Date.now()}),setWritingFilePath:t=>e({writingFilePath:t}),setFileStatus:(t,n)=>e(e=>({fileStatuses:{...e.fileStatuses,[t]:n}})),clearFileStatuses:()=>e({fileStatuses:{},writingFilePath:null}),setSections:t=>e({sections:t}),setModelMode:t=>e({modelMode:t}),setIsGenerating:t=>e({isGenerating:t}),setIsPlanning:t=>e({isPlanning:t}),appendThinkingContent:t=>e(e=>({thinkingContent:e.thinkingContent+t})),clearThinkingContent:()=>e({thinkingContent:""}),appendSystemConsoleContent:t=>e(e=>({systemConsoleContent:e.systemConsoleContent+t})),clearSystemConsoleContent:()=>e({systemConsoleContent:""}),setGenerationStatus:t=>e({generationStatus:t}),setError:t=>e({error:t}),setIsPreviewOpen:t=>e({isPreviewOpen:t}),setFiles:t=>e({files:t}),resetFiles:()=>e({files:E()}),resolveFilePath:e=>M(e),upsertFileNode:(t,n)=>e(e=>({files:R(T(e.files),t,n)})),upsertDirectoryNode:t=>e(e=>({files:$(T(e.files),t)})),appendToFileNode:(t,n)=>e(e=>({files:O(T(e.files),t,n)})),setFilesFromProjectFiles:t=>e({files:D(t)}),saveCurrentSession:()=>{let n=t(),r=f.getState().files,i=r.length>0?D(r):T(n.files);if(!(Object.keys(i).length>0||n.chatHistory.length>0||n.planSteps.length>0||n.plan.trim().length>0||n.lastPlannedPrompt.trim().length>0))return;let a=n.lastPlannedPrompt||n.prompt||"Untitled Session";e({history:[{id:"session-".concat(Date.now()),createdAt:Date.now(),title:a.slice(0,60),files:N(i),chatHistory:n.chatHistory.map(e=>({...e})),plan:n.plan,planSteps:n.planSteps.map(e=>({...e}))},...n.history]})},restoreSession:n=>{let r=t().history.find(e=>e.id===n);r&&e({files:N(r.files),chatHistory:r.chatHistory.map(e=>({...e})),plan:r.plan,planSteps:r.planSteps.map(e=>({...e})),prompt:"",lastPlannedPrompt:"",decisionTrace:"",streamText:"",thinkingContent:"",systemConsoleContent:"",fileStatuses:{},writingFilePath:null,sections:{},isGenerating:!1,isPlanning:!1,generationStatus:{isGenerating:!1,currentStep:"idle",progress:0},error:null,isPreviewOpen:!1})},startNewChat:()=>{t().saveCurrentSession(),e({files:E(),chatHistory:[],plan:"",planSteps:[],lastPlannedPrompt:"",prompt:"",decisionTrace:"",streamText:"",thinkingContent:"",systemConsoleContent:"",fileStatuses:{},writingFilePath:null,sections:{},isGenerating:!1,isPlanning:!1,generationStatus:{isGenerating:!1,currentStep:"idle",progress:0},error:null,isPreviewOpen:!1,interactionMode:"create"}),f.getState().reset(),window.location.reload()},reset:()=>e(_())}),{name:"nexus-ai-store",storage:(0,u.FL)(()=>localStorage)})),q={isExecuting:!1,executionResult:null,logs:[],previewUrl:null,previewContent:null,runtimeStatus:"idle",runtimeMessage:null},H=(0,h.Ue)(e=>({...q,setIsExecuting:t=>e({isExecuting:t}),setExecutionResult:t=>e({executionResult:t}),addLog:t=>e(e=>({logs:[...e.logs,t]})),clearLogs:()=>e({logs:[]}),setPreviewUrl:t=>e({previewUrl:t}),setPreviewContent:t=>e({previewContent:t}),setRuntimeStatus:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e({runtimeStatus:t,runtimeMessage:n})},reset:()=>e(q)}));function G(e){var t;return({js:"javascript",jsx:"javascript",ts:"typescript",tsx:"typescript",py:"python",html:"html",css:"css",json:"json",md:"markdown",cpp:"cpp",c:"c",java:"java",go:"go",rs:"rust",php:"php",rb:"ruby",sh:"shell",yml:"yaml",yaml:"yaml",xml:"xml",sql:"sql"})[(null===(t=e.split(".").pop())||void 0===t?void 0:t.toLowerCase())||""]||"plaintext"}var B=n(201),X=n(9567);let J=e=>{let{children:t,className:n="",hover:i=!0,glow:a="none",animated:o=!1}=e;return(0,r.jsx)("div",{className:"\n        liquid-glass \n        ".concat(i?"hover:transform hover:translate-y-[-2px]":"","\n        ").concat("blue"===a?"glow-blue":"","\n        ").concat("purple"===a?"glow-purple":"","\n        ").concat("cyan"===a?"glow-cyan":"","\n        ").concat(o?"glass-shimmer":"","\n        ").concat(n,"\n      "),children:t})};var Y=n(7610),V=n(3518),K=n(9624),Q=n(8929),ee=n(1978),et=n(5960),en=n(6515),er=n(3690),ei=n(227),ea=n(2869),eo=n(4713),es=n(2625);let el=e=>{var t;let n=null===(t=e.split(".").pop())||void 0===t?void 0:t.toLowerCase();return n?["ts","tsx","js","jsx","py","java","go","rs","cpp","c","cs","php"].includes(n)?Q.Z:["css","scss","sass","less"].includes(n)?ee.Z:["json","jsonc"].includes(n)?et.Z:["md","txt","env","yml","yaml"].includes(n)?en.Z:["html","htm"].includes(n)?Q.Z:K.Z:K.Z},ec=e=>"writing"===e?"rgba(250, 204, 21, 0.95)":"queued"===e?"rgba(59, 130, 246, 0.95)":"rgba(34, 197, 94, 0.95)",ed=e=>{let{node:t,depth:n}=e,[a,o]=i.useState(!0),{activeFile:s,setActiveFile:l}=f(),{fileStatuses:c,writingFilePath:d}=U(),p=i.useCallback(e=>{if("file"===e.type){let t=c[e.path];return d&&d===e.path?"writing":t||"ready"}let t=e.children||[],n=!1;for(let e of t){let t=p(e);if("writing"===t)return"writing";"queued"===t&&(n=!0)}return n?"queued":"ready"},[c,d]),g=s===t.path,h=p(t),u="writing"===h?er.Z:ei.Z,x=ec(h),m="file"===t.type?el(t.path):ea.Z;return(0,r.jsxs)("div",{children:[(0,r.jsxs)(Y.E.div,{className:"flex items-center gap-2 px-2 py-1.5 cursor-pointer rounded-md transition-colors ".concat(g?"bg-[#1f2428] text-white ring-1 ring-cyan-500/20 shadow-[0_0_18px_rgba(34,211,238,0.10)]":"hover:bg-[#161b22] text-white/80"),style:{paddingLeft:"".concat(12*n+8,"px")},onClick:()=>{"file"===t.type?l(t.path):o(!a)},layout:!0,initial:{opacity:0,x:-6},animate:{opacity:1,x:0},children:["directory"===t.type?(0,r.jsxs)(r.Fragment,{children:[a?(0,r.jsx)(eo.Z,{className:"w-4 h-4"}):(0,r.jsx)(es.Z,{className:"w-4 h-4"}),(0,r.jsx)(m,{className:"w-4 h-4 text-white/60"})]}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(m,{className:"w-4 h-4 text-gray-300 ml-4"})}),(0,r.jsx)("span",{className:"text-sm truncate",children:t.path.split("/").pop()}),"file"===t.type&&(0,r.jsxs)("span",{className:"ml-auto flex items-center gap-1.5 pr-1",children:[(0,r.jsx)(V.M,{children:"writing"===h&&(0,r.jsx)(Y.E.span,{initial:{opacity:0,y:-2},animate:{opacity:1,y:0},exit:{opacity:0,y:-2},className:"text-[10px] font-semibold tracking-wide text-yellow-200/90",children:"Writing…"})}),(0,r.jsx)(u,{className:"writing"===h?"w-4 h-4 animate-pulse":"w-4 h-4",style:{color:x}})]})]}),"directory"===t.type&&a&&t.children&&(0,r.jsx)("div",{children:t.children.map(e=>(0,r.jsx)(ed,{node:e,depth:n+1},e.path))})]})},ep=()=>{let{files:e,fileStructure:t}=f();if(0===e.length)return(0,r.jsx)("div",{className:"p-4 text-gray-500 text-sm",children:"No files yet. Generate code to get started."});let n=t.length>0?t:e.filter(e=>e.path).map(e=>({path:e.path,type:"file"}));return(0,r.jsx)("div",{className:"p-2 scrollbar-thin overflow-y-auto",children:n.map(e=>(0,r.jsx)(ed,{node:e,depth:0},e.path))})};var eg=n(2592),eh=n(5818),eu=n(9190);let ex="/api".replace(/\/+$/,""),ef=e=>"".concat(ex).concat(e.startsWith("/")?"":"/").concat(e),em={async downloadAsZip(e,t){try{let n=await eu.Z.post(ef("/download/zip"),{files:e},{responseType:"blob"}),r=new Blob([n.data],{type:"application/zip"}),i=window.URL.createObjectURL(r),a=document.createElement("a");a.href=i,a.download="".concat(t||"project",".zip"),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(i)}catch(e){throw console.error("Failed to download ZIP:",e),Error("Failed to download project")}}};var eb=n(5801),ew=n(2949);let ev=JSON.stringify({name:"project-root",scripts:{start:'concurrently "npm run server" "npm run client"',server:"cd backend && node server.js",client:"cd frontend && vite"},dependencies:{concurrently:"^8.0.0",express:"^4.18.0",sqlite3:"^5.1.0",cors:"^2.8.5",nodemon:"^3.0.0"}},null,2)+"\n",ey={bootPromise:null,instance:null,mounted:!1,fileCache:new Map,packageCache:new Map,serverProcess:null,apiKeyConfigured:!1},ej=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;for(let[i,a]of Object.entries(e)){let e=t?"".concat(t,"/").concat(i):i;if(a.file){var r;n.set(e,null!==(r=a.file.contents)&&void 0!==r?r:"")}a.directory&&ej(a.directory,e,n)}return n},ek=e=>{let t=new Map;for(let[n,r]of e.entries())n.endsWith("package.json")&&t.set(n,null!=r?r:"");return t},eC=e=>{try{return JSON.parse(e),!0}catch(e){return!1}},eP=(e,t)=>{let n=[],r=(e,i)=>{let a={};for(let[s,l]of Object.entries(e)){var o;let e=i?"".concat(i,"/").concat(s):s;if(l.directory){a[s]={directory:r(l.directory,e)};continue}if(!l.file)continue;let c=null!==(o=l.file.contents)&&void 0!==o?o:"";if("package.json"===s&&!eC(c)){n.push(e),"package.json"===e&&(a[s]={file:{contents:t}});continue}a[s]={file:{contents:c}}}return a};return{tree:r(e,""),invalidPaths:n}},eS=async(e,t)=>{let n=t.split("/");if(n.length<=1)return;let r=n.slice(0,-1).join("/");r&&await e.fs.mkdir(r,{recursive:!0})},eI=async(e,t)=>{if(!t||!e.output)return;let n=e.output.getReader(),r=new TextDecoder;for(;;){let{value:e,done:i}=await n.read();if(i)break;if("string"==typeof e){t(e);continue}e&&t(r.decode(e))}},eZ=async()=>{if(!ey.bootPromise){let e=ew.env.NEXT_PUBLIC_WC_CLIENT_ID;e&&!ey.apiKeyConfigured&&((0,eb.pT)(e),ey.apiKeyConfigured=!0),ey.bootPromise=eb.tw.boot({coep:"require-corp"})}return ey.instance=await ey.bootPromise,ey.instance},eE=async function(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=await eZ(),a=!0===r.ensureRootPackageJson,o=null!==(n=r.rootPackageJson)&&void 0!==n?n:ev,s=!!(null===(t=e["package.json"])||void 0===t?void 0:t.file),{tree:l,invalidPaths:c}=eP(a&&!s?{...e,"package.json":{file:{contents:o}}}:e,o),d=ej(l);if(!ey.mounted)return await i.mount(l),ey.mounted=!0,ey.fileCache=d,ey.packageCache=ek(d),{changedPackages:Array.from(ey.packageCache.keys()),injectedRootPackage:a&&!s,invalidPackageJsonPaths:c,fileMap:d};for(let[e,t]of d.entries())ey.fileCache.get(e)!==t&&(await eS(i,e),await i.fs.writeFile(e,t));let p=ek(d),g=[];for(let[e,t]of p.entries())ey.packageCache.get(e)!==t&&g.push(e);return ey.fileCache=d,ey.packageCache=p,{changedPackages:g,invalidPackageJsonPaths:c,fileMap:d}},eT=async function(e,t){let n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=await eZ();try{n=await i.spawn(e,t,{cwd:r.cwd})}catch(r){let n=r instanceof Error?r.message:String(r);throw Error("[webcontainer] spawn failed: ".concat(e," ").concat(t.join(" ")," (").concat(n,")"))}return eI(n,r.onOutput),{exitCode:await n.exit,process:n}},eN=async(e,t)=>eT("npm",["install"],{cwd:e,onOutput:t}),eF=async function(e,t){let n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(ey.serverProcess&&!r.force)return ey.serverProcess;if(ey.serverProcess&&r.force){try{ey.serverProcess.kill()}catch(e){}ey.serverProcess=null}let i=await eZ();try{n=await i.spawn(e,t,{cwd:r.cwd})}catch(r){let n=r instanceof Error?r.message:String(r);throw Error("[webcontainer] spawn failed: ".concat(e," ").concat(t.join(" ")," (").concat(n,")"))}return eI(n,r.onOutput),ey.serverProcess=n,n},ez=()=>{if(ey.serverProcess)try{ey.serverProcess.kill()}catch(e){}ey.mounted=!1,ey.fileCache.clear(),ey.packageCache.clear(),ey.serverProcess=null},eA=e=>e.replace(/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]/g,"");var eM=n(2949);let eL=(0,i.createContext)(null),eR=e=>Array.isArray(e)?{}:e,e$=e=>0===Object.keys(e).length,eO=(e,t)=>{for(let[n,r]of Object.entries(e))if(n.toLowerCase()===t.toLowerCase()&&r.file||r.directory&&eO(r.directory,t))return!0;return!1},eD=(e,t)=>{let n=t.split("/").filter(Boolean),r=e;for(let e=0;e<n.length;e+=1){let t=n[e],i=r?r[t]:void 0;if(!i)break;if(e===n.length-1)return!!(i.file||i.directory);if(!i.directory)break;r=i.directory}return!1},e_=e=>{var t;let n={...(null===(t=e[".apex"])||void 0===t?void 0:t.directory)||{},"static-server.cjs":{file:{contents:"const http = require('http');\nconst fs = require('fs');\nconst path = require('path');\n\nconst port = Number(process.env.PORT || 5173);\nconst root = process.cwd();\n\nconst contentTypes = {\n  '.html': 'text/html; charset=utf-8',\n  '.css': 'text/css; charset=utf-8',\n  '.js': 'text/javascript; charset=utf-8',\n  '.mjs': 'text/javascript; charset=utf-8',\n  '.json': 'application/json; charset=utf-8',\n  '.svg': 'image/svg+xml',\n  '.png': 'image/png',\n  '.jpg': 'image/jpeg',\n  '.jpeg': 'image/jpeg',\n  '.gif': 'image/gif',\n  '.ico': 'image/x-icon',\n  '.txt': 'text/plain; charset=utf-8'\n};\n\nconst resolveSafePath = (urlPath) => {\n  const decoded = decodeURIComponent(urlPath.split('?')[0] || '/');\n  const normalized = decoded.replace(/\\\\/g, '/');\n  const withoutLeading = normalized.replace(/^\\/+/, '');\n  const resolved = path.resolve(root, withoutLeading);\n  if (!resolved.startsWith(root)) return null;\n  return resolved;\n};\n\nconst send = (res, status, body, headers = {}) => {\n  res.writeHead(status, headers);\n  res.end(body);\n};\n\nconst server = http.createServer((req, res) => {\n  const safe = resolveSafePath(req.url || '/');\n  if (!safe) return send(res, 400, 'Bad Request');\n\n  let target = safe;\n  try {\n    const stat = fs.statSync(target);\n    if (stat.isDirectory()) target = path.join(target, 'index.html');\n  } catch {\n    // fall through\n  }\n\n  if (!fs.existsSync(target)) {\n    const index = path.join(root, 'index.html');\n    if (fs.existsSync(index)) target = index;\n  }\n\n  if (!fs.existsSync(target)) return send(res, 404, 'Not Found');\n\n  const ext = path.extname(target).toLowerCase();\n  const type = contentTypes[ext] || 'application/octet-stream';\n  try {\n    const buffer = fs.readFileSync(target);\n    send(res, 200, buffer, { 'Content-Type': type });\n  } catch (err) {\n    send(res, 500, String(err && err.message ? err.message : err));\n  }\n});\n\nserver.listen(port, () => {\n  console.log('[static] listening on', port);\n});\n"}}};return{...e,".apex":{directory:n}}},eW=e=>{let t="";return n=>{let r=(t+=eA(n)).split(/\r?\n/);for(let n of(t=r.pop()||"",r)){let t=n.trim();t.length>0&&e(t)}}},eU=e=>{let t=e.toLowerCase();return!!(t.includes("deprecated")||t.includes("npm fund")||t.includes("looking for funding"))},eq=e=>{let t=e.split("/");return t.length<=1?".":t.slice(0,-1).join("/")},eH=e=>{if(e.has("index.html")&&!Array.from(e.keys()).some(e=>e.endsWith("package.json")))return{command:"node",args:[".apex/static-server.cjs"],cwd:"."};let t=Array.from(e.keys()).filter(e=>e.endsWith("package.json")),n=["package.json","frontend/package.json","client/package.json","backend/package.json"];for(let r of(t.sort((e,t)=>{let r=n.indexOf(e),i=n.indexOf(t);return -1!==r||-1!==i?(-1===r?999:r)-(-1===i?999:i):e.localeCompare(t)}),t)){let t=e.get(r);if(t)try{let e=JSON.parse(t),n=(null==e?void 0:e.scripts)||{},i=eq(r);if(null==n?void 0:n.start)return{command:"npm",args:["run","start"],cwd:i};if(null==n?void 0:n.dev)return{command:"npm",args:["run","dev"],cwd:i}}catch(e){}}let r=e.get("package.json");if(r)try{let e=JSON.parse(r),t=(null==e?void 0:e.scripts)||{};if(null==t?void 0:t.start)return{command:"npm",args:["run","start"],cwd:"."}}catch(e){}return e.has("backend/server.js")?{command:"node",args:["backend/server.js"],cwd:"."}:e.has("backend/src/server.js")?{command:"node",args:["backend/src/server.js"],cwd:"."}:null},eG=e=>{let{children:t}=e,{files:n,isPreviewOpen:a,isGenerating:o,appendSystemConsoleContent:s}=U(),{addLog:l,setPreviewUrl:c,setRuntimeStatus:d}=H(),p=()=>new Date().toLocaleTimeString([],{hour12:!1}),[g,h]=(0,i.useState)("idle"),[u,x]=(0,i.useState)(null),[f,m]=(0,i.useState)(null),b=(0,i.useRef)(!1),w=(0,i.useRef)(!1),v=(0,i.useRef)({}),y=(0,i.useRef)(null),j=(0,i.useCallback)((e,t)=>{h(e),d(e,t||null)},[d]),k=(0,i.useCallback)(e=>{x(e),c(e)},[c]),C=(0,i.useCallback)(async()=>{b.current||((await eZ()).on("server-ready",(e,t)=>{v.current[e]=t,k(v.current[5173]||v.current[3111]||v.current[3e3]||t),j("ready","Server ready on port ".concat(e)),l({timestamp:Date.now(),type:"success",message:"Server ready on port ".concat(e),source:"webcontainer"})}),b.current=!0)},[l,j,k]),P=(0,i.useCallback)((e,t)=>new Promise((n,r)=>{let i=Date.now(),a=()=>{let o=v.current;return t.some(e=>!!o[e])?n():Date.now()-i>e?r(Error("WebContainer server-ready timeout (10s). Check root /package.json scripts and ports 5173/3111.")):void setTimeout(a,120)};a()}),[]),S=(0,i.useCallback)(async e=>{if(0===e.length)return;j("installing","Installing dependencies..."),s("".concat(p()," [webcontainer] Installing dependencies...\n"));let t=eW(e=>{eU(e)||(s("".concat(p()," ").concat(e,"\n")),l({timestamp:Date.now(),type:"info",message:e,source:"npm"}))});for(let n of e){let e=eq(n),{exitCode:r}=await eN(e,t);if(0!==r)throw Error("npm install failed in ".concat(e," (exit ").concat(r,")"))}},[l,s,j]),I=(0,i.useCallback)(async e=>{let t=eR(n);if(!a||e$(t))return;let r=eD(t,"index.html")&&!eO(t,"package.json")&&!eD(t,"vite.config.ts")&&!eD(t,"vite.config.js");m(null),(!w.current||e)&&k(null),j("booting","Booting container..."),await eZ(),await C(),v.current={},j("mounting","Syncing files...");let i=r?e_(t):t,o=!r&&!eO(t,"package.json"),{changedPackages:c,injectedRootPackage:d,invalidPackageJsonPaths:g,fileMap:h}=await eE(i,{ensureRootPackageJson:o,rootPackageJson:ev});d&&s("".concat(p()," [webcontainer] Injected root /package.json (missing).\\n")),g.length>0&&s("".concat(p()," [webcontainer] Skipped invalid package.json: ").concat(g.join(", "),"\\n"));let u=g.filter(e=>"package.json"!==e);if(u.length>0)throw Error("Invalid package.json generated: ".concat(u.join(", ")));let x=c.filter(e=>(h.get(e)||"").trim().length>10);if(r?(!w.current||e)&&s("".concat(p()," [webcontainer] Static project detected; skipping npm install.\\n")):await S(x),w.current&&!e){j("ready","Server running.");return}let f=eH(h);if(!f){j("idle","Waiting for entrypoint...");return}j("starting","Starting server...");let b=eW(e=>{eU(e)||l({timestamp:Date.now(),type:"info",message:e,source:"server"})}),y=await eF(f.command,f.args,{cwd:f.cwd,onOutput:b,force:e});w.current=!0,await Promise.race([P(1e4,[5173,3111,3e3]),y.exit.then(e=>{throw Error("Server process exited (".concat(e,"). Check logs for details."))})])},[l,s,C,n,a,S,j,k]);(0,i.useEffect)(()=>{if(!a){j("idle"),k(null);return}if(e$(eR(n))){ez(),w.current=!1,j("idle"),k(null);return}},[n,a,j,k]);let Z=(0,i.useCallback)(async()=>{if(o){j("idle","Waiting for code generation to finish..."),s("".concat(p()," [webcontainer] Waiting for code generation to finish...\\n"));return}return eM.env.NEXT_PUBLIC_WC_CLIENT_ID&&s("".concat(p()," [webcontainer] Authenticated with Enterprise API Key.\\n")),y.current||(y.current=I(!0).catch(e=>{let t=e instanceof Error?e.message:String(e);throw m(t),j("error",t),e}).finally(()=>{y.current=null})),y.current},[s,I,o,j]),E=(0,i.useCallback)(async()=>{w.current=!1,await Z()},[Z]);return(0,r.jsx)(eL.Provider,{value:{status:g,url:u,error:f,deployAndRun:Z,runProject:E,restart:E},children:t})},eB=()=>{let e=(0,i.useContext)(eL);if(!e)throw Error("useWebContainer must be used within WebContainerProvider");return e},eX=e=>{var t;let{showFileTree:n=!0}=e,{files:a,activeFile:o,setActiveFile:s,updateFile:l,projectName:c,isHydrating:d}=f(),[g,h,u,x,m,b]=U(e=>[e.isGenerating,e.streamText,e.modelMode,e.isPlanning,e.writingFilePath,e.setIsPreviewOpen],X.X),{addLog:w}=H(),{runProject:v}=eB(),[y,j]=i.useState([]),k=a.find(e=>e.path===o),C=k?k.language||G(k.path||k.name||""):"plaintext",P=(0,i.useRef)(null),S=(0,i.useRef)(""),[I,Z]=i.useState("");(0,i.useEffect)(()=>{o&&j(e=>e.includes(o)?e:[...e,o])},[o]),(0,i.useEffect)(()=>{if(0===a.length||o&&a.some(e=>e.path===o))return;let e=a[0],t=e.path||e.name;t&&s(t)},[o,a,s]);let E=(e,t)=>{t.stopPropagation();let n=y.filter(t=>t!==e);j(n),o===e&&n.length>0&&s(n[n.length-1])},T=async()=>{if(0!==a.length){b(!0),w({timestamp:Date.now(),type:"info",message:"Booting WebContainer preview..."});try{await v()}catch(e){w({timestamp:Date.now(),type:"error",message:(null==e?void 0:e.message)||"Failed to start WebContainer"})}}},N=async()=>{if(0!==a.length)try{await em.downloadAsZip(a,c||"nexus-project"),w({timestamp:Date.now(),type:"success",message:"Project downloaded successfully!"})}catch(e){w({timestamp:Date.now(),type:"error",message:"Failed to download project"})}},F=g&&0===a.length&&h.length>0,z=null!==(t=null==k?void 0:k.content)&&void 0!==t?t:"";(0,i.useEffect)(()=>{S.current=z},[z]),(0,i.useEffect)(()=>{if(!k){Z("");return}if(!g){P.current&&(window.clearInterval(P.current),P.current=null),Z(z);return}return Z(e=>S.current.startsWith(e)?e:S.current),P.current||(P.current=window.setInterval(()=>{Z(e=>{let t=S.current;if(e===t)return e;let n=t.indexOf("\n",e.length),r=Math.min(e.length+140,t.length),i=-1!==n&&n<r?Math.min(n+1,t.length):r;return t.slice(0,i)})},22)),()=>{P.current&&(window.clearInterval(P.current),P.current=null)}},[o,k,g]);let A=(0,i.useMemo)(()=>F?h:k?g?I:z:void 0,[k,g,F,z,h,I]);return d&&0===a.length?(0,r.jsx)(J,{className:"h-full flex flex-col overflow-hidden",children:(0,r.jsx)("div",{className:"flex-1 min-h-0 p-4",children:(0,r.jsx)("div",{className:"h-full rounded-xl border border-white/10 bg-white/5 backdrop-blur-2xl animate-pulse"})})}):(0,r.jsx)(J,{className:"h-full flex flex-col overflow-hidden",children:(0,r.jsxs)("div",{className:"flex-1 min-h-0 flex flex-col md:flex-row",children:[n&&(0,r.jsxs)("div",{className:"w-full md:w-64 min-h-0 border-b md:border-b-0 md:border-r border-white/10 glass-panel",children:[(0,r.jsx)("div",{className:"p-3 border-b border-white/10",children:(0,r.jsx)("h3",{className:"text-sm font-semibold text-white/80",children:"Files"})}),(0,r.jsx)(ep,{})]}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,r.jsxs)("div",{className:"flex items-center border-b border-white/10 glass-panel",children:[(0,r.jsx)("div",{className:"flex-1 flex overflow-x-auto scrollbar-thin",children:y.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 border-r border-white/10 cursor-pointer transition-colors whitespace-nowrap ".concat(o===e?"bg-white/5 text-white/90":"hover:bg-white/5"),onClick:()=>s(e),children:[(0,r.jsx)("span",{className:"text-sm truncate max-w-[150px]",children:e.split("/").pop()}),(0,r.jsx)(p.Z,{className:"w-3 h-3 hover:text-red-400 flex-shrink-0",onClick:t=>E(e,t)})]},e))}),(0,r.jsxs)("div",{className:"flex items-center gap-2 px-3",children:[(0,r.jsxs)("button",{onClick:T,className:"glass-button px-4 py-1.5 rounded flex items-center justify-center gap-2 text-sm",disabled:0===a.length||g||!!m,children:[(0,r.jsx)(eg.Z,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Run"})]}),(0,r.jsxs)("button",{onClick:N,className:"glass-button px-4 py-1.5 rounded flex items-center justify-center gap-2 text-sm",disabled:0===a.length,children:[(0,r.jsx)(eh.Z,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"ZIP"})]})]})]}),(0,r.jsx)("div",{className:"flex-1 overflow-hidden min-h-0",children:F||k?(0,r.jsx)(B.ZP,{height:"100%",language:F?"markdown":C,value:A,onChange:e=>{!g&&o&&void 0!==e&&l(o,e)},theme:"vs-dark",options:{minimap:{enabled:!0},fontSize:14,lineNumbers:"on",roundedSelection:!0,scrollBeyondLastLine:!1,automaticLayout:!0,tabSize:2,wordWrap:"on",readOnly:F}}):(0,r.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500",children:(0,r.jsx)("p",{children:"Select a file to edit"})})}),(0,r.jsxs)("div",{className:"h-9 flex items-center justify-between px-3 border-t border-white/10 glass-panel",children:[(0,r.jsx)("div",{className:"text-xs text-white/70",children:x?"Creating plan…":g?"Generating…":"Ready"}),(0,r.jsx)("div",{className:"text-xs text-white/50",children:"thinking"===u?"Thinking mode":"Fast mode"})]})]})]})})};var eJ=n(6946),eY=n(9775);let eV=a.ZP.div.withConfig({componentId:"sc-dd8fa735-0"})(["height:100%;display:flex;flex-direction:column;border-radius:18px;border:1px solid rgba(255,255,255,0.12);background:rgba(255,255,255,0.04);backdrop-filter:blur(18px);box-shadow:0 22px 60px rgba(0,0,0,0.55),inset 0 1px 0 rgba(255,255,255,0.10);overflow:hidden;min-height:0;"]),eK=a.ZP.div.withConfig({componentId:"sc-dd8fa735-1"})(["display:grid;gap:10px;padding:12px 10px 10px;border-bottom:1px solid rgba(255,255,255,0.10);background:rgba(13,17,23,0.35);"]),eQ=a.ZP.div.withConfig({componentId:"sc-dd8fa735-2"})(["display:flex;align-items:center;justify-content:space-between;gap:10px;"]),e0=a.ZP.div.withConfig({componentId:"sc-dd8fa735-3"})(["font-weight:950;letter-spacing:0.14em;text-transform:uppercase;font-size:12px;color:rgba(255,255,255,0.84);"]),e5=a.ZP.div.withConfig({componentId:"sc-dd8fa735-4"})(["display:grid;grid-template-columns:1fr 1fr;gap:8px;"]),e2=a.ZP.button.withConfig({componentId:"sc-dd8fa735-5"})(["height:32px;border-radius:14px;border:1px solid ",";background:",";color:",";display:inline-flex;align-items:center;justify-content:center;gap:8px;font-size:12px;font-weight:900;letter-spacing:0.06em;text-transform:uppercase;cursor:pointer;transition:background 160ms ease,border-color 160ms ease,transform 160ms ease;&:hover{border-color:rgba(168,85,247,0.22);background:rgba(255,255,255,0.05);transform:translateY(-1px);}"],e=>e.$active?"rgba(34, 211, 238, 0.28)":"rgba(255, 255, 255, 0.10)",e=>e.$active?"rgba(34, 211, 238, 0.10)":"rgba(255, 255, 255, 0.03)",e=>e.$active?"rgba(255,255,255,0.90)":"rgba(255,255,255,0.70)"),e1=a.ZP.div.withConfig({componentId:"sc-dd8fa735-6"})(["flex:1;min-height:0;overflow:hidden;"]),e8=a.ZP.div.withConfig({componentId:"sc-dd8fa735-7"})(["height:100%;padding:12px 10px;overflow-y:auto;"]),e4=a.ZP.button.withConfig({componentId:"sc-dd8fa735-8"})(["width:100%;display:flex;align-items:center;gap:8px;padding:6px 8px;border-radius:10px;border:0;background:",";color:",";cursor:pointer;text-align:left;&:hover{background:rgba(255,255,255,0.07);color:rgba(255,255,255,0.9);}"],e=>e.$active?"rgba(255, 255, 255, 0.08)":"transparent",e=>e.$active?"rgba(255, 255, 255, 0.94)":"rgba(255, 255, 255, 0.76)"),e6=a.ZP.span.withConfig({componentId:"sc-dd8fa735-9"})(["font-size:12px;font-weight:600;flex:1;min-width:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;"]),e9=a.ZP.span.withConfig({componentId:"sc-dd8fa735-10"})(["display:inline-flex;align-items:center;gap:6px;"]),e3=a.ZP.span.withConfig({componentId:"sc-dd8fa735-11"})(["font-size:10px;font-weight:800;letter-spacing:0.06em;text-transform:uppercase;color:rgba(250,204,21,0.85);"]),e7=a.ZP.span.withConfig({componentId:"sc-dd8fa735-12"})(["width:8px;height:8px;border-radius:999px;background:",";"],e=>e.$color),te=a.ZP.div.withConfig({componentId:"sc-dd8fa735-13"})(["padding:14px;border-radius:12px;border:1px dashed rgba(255,255,255,0.16);color:rgba(255,255,255,0.5);font-size:12px;text-align:center;"]),tt=(0,a.F4)(["0%{background-position:0% 50%;opacity:0.6;}100%{background-position:180% 50%;opacity:0.9;}"]),tn=a.ZP.div.withConfig({componentId:"sc-dd8fa735-14"})(["height:28px;border-radius:10px;border:1px solid rgba(255,255,255,0.08);background:linear-gradient( 90deg,rgba(255,255,255,0.05),rgba(255,255,255,0.09),rgba(255,255,255,0.05) );background-size:220% 100%;animation:"," 1.3s linear infinite;"],tt),tr=a.ZP.div.withConfig({componentId:"sc-dd8fa735-15"})(["display:grid;gap:8px;padding:6px 4px;"]),ti=a.ZP.div.withConfig({componentId:"sc-dd8fa735-16"})(["flex-shrink:0;padding:10px;border-top:1px solid rgba(255,255,255,0.10);background:rgba(13,17,23,0.25);display:grid;grid-template-columns:1fr auto;align-items:center;gap:10px;"]),ta=a.ZP.div.withConfig({componentId:"sc-dd8fa735-17"})(["display:grid;gap:2px;min-width:0;"]),to=a.ZP.div.withConfig({componentId:"sc-dd8fa735-18"})(["font-size:10px;font-weight:800;letter-spacing:0.10em;text-transform:uppercase;color:rgba(255,255,255,0.55);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;"]),ts=a.ZP.button.withConfig({componentId:"sc-dd8fa735-19"})(["width:36px;height:36px;border-radius:14px;border:1px solid rgba(255,255,255,0.10);background:rgba(255,255,255,0.03);color:rgba(255,255,255,0.78);display:grid;place-items:center;cursor:pointer;transition:background 160ms ease,border-color 160ms ease,transform 160ms ease;&:hover{background:rgba(255,255,255,0.06);border-color:rgba(255,255,255,0.16);transform:translateY(-1px);}"]),tl=e=>"writing"===e?"rgba(250, 204, 21, 0.95)":"queued"===e?"rgba(59, 130, 246, 0.95)":"rgba(34, 197, 94, 0.95)",tc=e=>Array.isArray(e)?{}:e,td=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";for(let[r,i]of Object.entries(e)){let e=n?"".concat(n,"/").concat(r):r;if(e.startsWith(t)||i.directory&&td(i.directory,t,e))return!0}return!1},tp=(e,t)=>{var n,r;let i=null===(r=e["package.json"])||void 0===r?void 0:null===(n=r.file)||void 0===n?void 0:n.contents;return!!("string"==typeof i&&i.includes('"'.concat(t,'"')))},tg=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object.entries(e).map(e=>{let[n,r]=e,i=t?"".concat(t,"/").concat(n):n;return r.directory?{name:n,path:i,type:"folder",children:tg(r.directory,i)}:{name:n,path:i,type:"file"}}).sort((e,t)=>e.type!==t.type?"folder"===e.type?-1:1:e.name.localeCompare(t.name))},th=e=>{var t;let{node:n,depth:i,openNodes:a,onToggle:o,onSelectFile:s,activeFile:l,getStatus:c}=e,d="folder"===n.type,p="file"===n.type&&l===n.path,g=!!d&&(null!==(t=a[n.path])&&void 0!==t?t:0===i),h="file"===n.type?c(n.path):"ready",u=tl(h);return(0,r.jsxs)("div",{children:[(0,r.jsxs)(e4,{type:"button",$active:p,onClick:()=>{if(d){o(n.path);return}s(n.path)},style:{paddingLeft:"".concat(14*i+10,"px")},"aria-expanded":d?g:void 0,children:[d?(0,r.jsxs)(r.Fragment,{children:[g?(0,r.jsx)(eo.Z,{size:14}):(0,r.jsx)(es.Z,{size:14}),(0,r.jsx)(ea.Z,{size:16})]}):(0,r.jsx)(en.Z,{size:16}),(0,r.jsx)(e6,{children:n.name}),"file"===n.type&&(0,r.jsxs)(e9,{children:["writing"===h&&(0,r.jsx)(e3,{children:"Writing"}),(0,r.jsx)(e7,{$color:u})]})]}),d&&g&&n.children&&n.children.length>0&&(0,r.jsx)("div",{children:n.children.map(e=>(0,r.jsx)(th,{node:e,depth:i+1,openNodes:a,onToggle:o,onSelectFile:s,activeFile:l,getStatus:c},e.path))})]})},tu=e=>{let{className:t,onOpenSettings:n}=e,[a,o]=(0,i.useState)("files"),[s,l]=(0,i.useState)({}),{files:c,fileStatuses:d,writingFilePath:p}=U(),{activeFile:g,setActiveFile:h,files:u,isHydrating:x,stack:m}=f(),{runtimeStatus:b}=H(),w=(0,i.useCallback)(e=>{l(t=>({...t,[e]:!t[e]}))},[]),v=(0,i.useCallback)(e=>{let t=d[e];return p&&p===e?"writing":t||"ready"},[d,p]),y=(0,i.useMemo)(()=>tc(c),[c]),j=(0,i.useMemo)(()=>tg(y),[y]),k=(0,i.useMemo)(()=>{var e;return!!(td(y,"convex/")||td(y,"frontend/convex/")||tp(y,"convex")||((null===(e=u.find(e=>"package.json"===(e.path||e.name)))||void 0===e?void 0:e.content)||"").includes('"convex"'))},[u,y]),C=(0,i.useMemo)(()=>{let e=u.find(e=>"convex/schema.ts"===(e.path||e.name))||u.find(e=>"convex/schema.js"===(e.path||e.name))||u.find(e=>"convex/schema.tsx"===(e.path||e.name))||null;return(null==e?void 0:e.content)||""},[u]),P=(0,i.useMemo)(()=>{if(!C)return[];let e=new Set;for(let t of C.split(/\r?\n/)){let n=t.match(/^\s*([a-zA-Z0-9_]+)\s*:\s*defineTable\s*\(/);(null==n?void 0:n[1])&&e.add(n[1])}return Array.from(e).sort((e,t)=>e.localeCompare(t))},[C]),S=(0,i.useMemo)(()=>C?(C.length>2200?"".concat(C.slice(0,2200),"\n\n// [[TRUNCATED]]"):C).trim():"",[C]);return(0,r.jsxs)(eV,{className:t,children:[(0,r.jsxs)(eK,{children:[(0,r.jsx)(eQ,{children:(0,r.jsx)(e0,{children:"SIDEBAR"})}),(0,r.jsxs)(e5,{children:[(0,r.jsx)(e2,{type:"button",$active:"files"===a,onClick:()=>o("files"),"aria-label":"Files",children:"Files"}),(0,r.jsx)(e2,{type:"button",$active:"database"===a,onClick:()=>o("database"),"aria-label":"Database",children:"Database"})]})]}),(0,r.jsx)(e1,{children:"files"===a?(0,r.jsx)(e8,{className:"scrollbar-thin scrollbar-glass",children:x&&0===j.length?(0,r.jsx)(tr,{"aria-label":"Loading files",children:Array.from({length:10}).map((e,t)=>(0,r.jsx)(tn,{},t))}):0===j.length?(0,r.jsx)(te,{children:"No files yet. Generate code to get started."}):j.map(e=>(0,r.jsx)(th,{node:e,depth:0,openNodes:s,onToggle:w,onSelectFile:h,activeFile:g,getStatus:v},e.path))}):(0,r.jsx)(e8,{className:"scrollbar-thin scrollbar-glass",children:(0,r.jsxs)("div",{style:{display:"grid",gap:10},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,r.jsx)(eJ.Z,{size:16}),(0,r.jsx)("div",{style:{fontSize:12,fontWeight:900,letterSpacing:"0.12em",textTransform:"uppercase"},children:"Database"})]}),(0,r.jsx)("div",{style:{fontSize:12,color:"rgba(255,255,255,0.70)",lineHeight:1.5},children:k?"Convex detected. Schema + data live in your project.":"No Database Required."}),k&&(0,r.jsxs)("div",{style:{borderRadius:14,border:"1px solid rgba(255,255,255,0.10)",background:"rgba(255,255,255,0.03)",padding:12,display:"grid",gap:8},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:10,alignItems:"center"},children:[(0,r.jsx)("div",{style:{fontSize:11,fontWeight:900,letterSpacing:"0.12em",textTransform:"uppercase",color:"rgba(255,255,255,0.72)"},children:"Schema"}),(0,r.jsx)("div",{style:{fontSize:11,fontWeight:800,color:"rgba(255,255,255,0.50)"},children:P.length>0?"Tables: ".concat(P.join(", ")):"Tables: —"})]}),S?(0,r.jsx)("pre",{style:{margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:11,lineHeight:1.45,color:"rgba(255,255,255,0.70)"},children:S}):(0,r.jsx)("div",{style:{fontSize:12,color:"rgba(255,255,255,0.55)"},children:"No `convex/schema.ts` found yet. Ask the AI to create it."})]})]})})}),(0,r.jsxs)(ti,{children:[(0,r.jsxs)(ta,{children:[(0,r.jsxs)(to,{children:["Stack: ",m||"Auto"]}),(0,r.jsxs)(to,{children:["Build: ",b]})]}),(0,r.jsx)(ts,{type:"button","aria-label":"Settings",title:"Settings",onClick:n,children:(0,r.jsx)(eY.Z,{size:16})})]})]})};var tx=n(1397);let tf=a.ZP.div.withConfig({componentId:"sc-1de58bfd-0"})(["height:100%;display:flex;flex-direction:column;gap:10px;padding:10px;overflow:hidden;"]),tm=a.ZP.div.withConfig({componentId:"sc-1de58bfd-1"})(["display:flex;gap:8px;"]),tb=a.ZP.button.withConfig({componentId:"sc-1de58bfd-2"})(["flex:1;height:32px;border-radius:999px;border:1px solid rgba(255,255,255,0.12);background:rgba(255,255,255,0.04);color:rgba(255,255,255,0.78);font-size:11px;font-weight:800;letter-spacing:0.06em;text-transform:uppercase;display:inline-flex;align-items:center;justify-content:center;gap:8px;min-width:0;white-space:nowrap;transition:background 160ms ease,border-color 160ms ease,transform 160ms ease;cursor:pointer;& svg{flex-shrink:0;}&:hover{border-color:rgba(34,211,238,0.24);background:rgba(255,255,255,0.08);transform:translateY(-1px);}"]),tw=a.ZP.div.withConfig({componentId:"sc-1de58bfd-3"})(["flex:1;min-height:0;overflow-y:auto;display:grid;gap:8px;padding-right:2px;"]),tv=a.ZP.button.withConfig({componentId:"sc-1de58bfd-4"})(["width:100%;border:1px solid rgba(255,255,255,0.08);border-radius:14px;padding:8px 10px;background:rgba(255,255,255,0.035);display:flex;align-items:center;gap:10px;cursor:pointer;text-align:left;transition:background 160ms ease,border-color 160ms ease,transform 160ms ease;&:hover{background:rgba(255,255,255,0.06);border-color:rgba(255,255,255,0.14);transform:translateY(-1px);}"]),ty=a.ZP.div.withConfig({componentId:"sc-1de58bfd-5"})(["flex:1;min-width:0;display:flex;align-items:baseline;gap:10px;"]),tj=a.ZP.div.withConfig({componentId:"sc-1de58bfd-6"})(["font-size:12px;font-weight:800;color:rgba(255,255,255,0.88);min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]),tk=a.ZP.div.withConfig({componentId:"sc-1de58bfd-7"})(["font-size:11px;color:rgba(255,255,255,0.52);white-space:nowrap;"]),tC=a.ZP.div.withConfig({componentId:"sc-1de58bfd-8"})(["display:flex;align-items:center;gap:10px;color:rgba(255,255,255,0.55);font-size:11px;white-space:nowrap;"]),tP=a.ZP.div.withConfig({componentId:"sc-1de58bfd-9"})(["padding:14px;border-radius:12px;border:1px dashed rgba(255,255,255,0.14);color:rgba(255,255,255,0.5);font-size:12px;text-align:center;"]),tS=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=[];for(let[r,i]of Object.entries(e)){let e=t?"".concat(t,"/").concat(r):r;i.directory&&n.push(...tS(i.directory,e)),i.file&&n.push({name:r,path:e,content:i.file.contents,language:G(e)})}return n},tI=e=>{let t=new Date(e);if(Number.isNaN(t.getTime()))return"??/??";let n=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0");return"".concat(n,"/").concat(r)},tZ=()=>{let{history:e,saveCurrentSession:t,startNewChat:n,restoreSession:i}=U(),{setFiles:a,setFileStructure:o,setActiveFile:l}=f(),c=t=>{let n=e.find(e=>e.id===t);if(!n)return;i(t);let r=tS(n.files);if(a(r),o(r.map(e=>({path:e.path||e.name,type:"file"}))),r.length>0){let e=r[0].path||r[0].name;e&&l(e)}};return(0,r.jsxs)(tf,{children:[(0,r.jsxs)(tm,{children:[(0,r.jsxs)(tb,{type:"button",onClick:t,children:[(0,r.jsx)(tx.Z,{size:14}),"Save"]}),(0,r.jsxs)(tb,{type:"button",onClick:n,children:[(0,r.jsx)(s.Z,{size:14}),"New Chat"]})]}),(0,r.jsx)(tw,{className:"scrollbar-thin scrollbar-glass",children:0===e.length?(0,r.jsx)(tP,{children:"No saved sessions yet."}):e.map(e=>(0,r.jsxs)(tv,{type:"button",onClick:()=>c(e.id),children:[(0,r.jsxs)(ty,{children:[(0,r.jsx)(tj,{children:e.title||"Untitled Session"}),(0,r.jsxs)(tk,{children:["Date: ",tI(e.createdAt)]})]}),(0,r.jsx)(tC,{children:"Restore"})]},e.id))})]})},tE=a.ZP.div.withConfig({componentId:"sc-cdb0d48a-0"})(["width:100%;max-width:1000px;margin:0 auto;flex-shrink:0;position:relative;border-radius:22px;border:1px solid ",";background:rgba(255,255,255,0.05);backdrop-filter:blur(18px);box-shadow:0 22px 60px rgba(0,0,0,0.55),inset 0 1px 0 rgba(255,255,255,0.10);overflow:hidden;min-height:92px;display:flex;align-items:stretch;gap:12px;padding:12px;@media (max-width:768px){position:fixed;left:14px;right:14px;bottom:14px;max-width:none;z-index:80;flex-direction:column;}"],e=>"edit"===e.$mode?"rgba(168, 85, 247, 0.35)":"rgba(255, 255, 255, 0.14)"),tT=a.ZP.div.withConfig({componentId:"sc-cdb0d48a-1"})(["position:absolute;inset:-10px;border-radius:18px;background:radial-gradient(260px 140px at 15% 25%,rgba(34,211,238,0.26),transparent 60%),radial-gradient(260px 140px at 85% 75%,rgba(168,85,247,","),transparent 60%);filter:blur(18px);opacity:0.9;pointer-events:none;"],e=>"edit"===e.$mode?.34:.22),tN=a.ZP.textarea.withConfig({componentId:"sc-cdb0d48a-2"})(["width:100%;flex:1;min-width:0;min-height:68px;max-height:220px;resize:none;padding:4px 2px;border-radius:0;border:0;background:transparent;color:rgba(255,255,255,0.92);font-size:15px;line-height:1.4;outline:none;&::placeholder{color:rgba(255,255,255,0.40);}&:focus{color:rgba(255,255,255,0.96);}"]),tF=a.ZP.div.withConfig({componentId:"sc-cdb0d48a-3"})(["display:inline-flex;align-items:center;justify-content:flex-end;gap:10px;flex-shrink:0;padding-left:12px;border-left:1px solid rgba(255,255,255,0.10);@media (max-width:768px){border-left:0;padding-left:0;padding-top:10px;border-top:1px solid rgba(255,255,255,0.10);justify-content:space-between;flex-wrap:wrap;}"]),tz=(0,i.forwardRef)((e,t)=>{let{placeholder:n,controls:i,className:a}=e,{prompt:o,setPrompt:s,isGenerating:l,interactionMode:c}=U(),d="edit"===c?"edit":"create";return(0,r.jsxs)(tE,{className:a,$mode:d,children:[(0,r.jsx)(tT,{$mode:d}),(0,r.jsx)(tN,{ref:t,$mode:d,value:o,onChange:e=>s(e.target.value),placeholder:n||("edit"===d?"What would you like to change in the current code?":"Describe what you want to build…"),disabled:l}),i?(0,r.jsx)(tF,{children:i}):null]})});tz.displayName="PromptInput";let tA=a.ZP.div.withConfig({componentId:"sc-52ef591a-0"})(["position:relative;display:inline-flex;align-items:center;padding:6px;border-radius:999px;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.12);backdrop-filter:blur(16px);box-shadow:0 12px 28px rgba(0,0,0,0.35),inset 0 1px 0 rgba(255,255,255,0.08);user-select:none;"]),tM=a.ZP.div.withConfig({componentId:"sc-52ef591a-1"})(["position:absolute;inset:-1px;border-radius:999px;pointer-events:none;background:radial-gradient(120px 60px at 20% 30%,rgba(56,189,248,0.25),transparent 60%),radial-gradient(140px 70px at 80% 70%,rgba(168,85,247,0.25),transparent 60%);filter:blur(10px);opacity:0.9;"]),tL=a.ZP.button.withConfig({componentId:"sc-52ef591a-2"})(["position:relative;z-index:1;display:grid;grid-template-columns:1fr 1fr;gap:4px;align-items:center;border:0;background:transparent;padding:0;cursor:pointer;outline:none;"]),tR=a.ZP.div.withConfig({componentId:"sc-52ef591a-3"})(["position:relative;height:38px;min-width:88px;display:inline-flex;align-items:center;justify-content:center;border-radius:999px;font-weight:800;letter-spacing:0.12em;font-size:12px;color:",";"],e=>e.$active?"rgba(255,255,255,0.92)":"rgba(255,255,255,0.55)"),t$=(0,a.ZP)(Y.E.div).withConfig({componentId:"sc-52ef591a-4"})(["position:absolute;top:6px;left:6px;width:calc(50% - 6px);height:38px;border-radius:999px;background:linear-gradient(135deg,rgba(59,130,246,0.25),rgba(168,85,247,0.22));border:1px solid rgba(255,255,255,0.16);box-shadow:0 10px 24px rgba(0,0,0,0.35),inset 0 1px 0 rgba(255,255,255,0.14);"]),tO=e=>{let{className:t}=e,{modelMode:n,setModelMode:i,isGenerating:a}=U(),o="thinking"===n;return(0,r.jsxs)(tA,{className:t,children:[(0,r.jsx)(tM,{}),(0,r.jsx)(t$,{animate:{x:o?"100%":"0%"},transition:{type:"spring",stiffness:420,damping:34}}),(0,r.jsxs)(tL,{type:"button","aria-label":"Mode toggle","aria-pressed":o,onClick:()=>i(o?"fast":"thinking"),disabled:a,children:[(0,r.jsx)(tR,{$active:!o,children:"FAST"}),(0,r.jsx)(tR,{$active:o,children:"THINKING"})]})]})},tD=a.ZP.div.withConfig({componentId:"sc-308f91e0-0"})(["display:inline-flex;align-items:center;gap:10px;user-select:none;"]),t_=a.ZP.div.withConfig({componentId:"sc-308f91e0-1"})(["font-size:12px;font-weight:900;letter-spacing:0.10em;text-transform:uppercase;color:rgba(255,255,255,0.70);white-space:nowrap;"]),tW=a.ZP.button.withConfig({componentId:"sc-308f91e0-2"})(["position:relative;width:54px;height:34px;border-radius:999px;border:1px solid rgba(255,255,255,0.14);background:rgba(255,255,255,0.06);backdrop-filter:blur(16px);box-shadow:0 14px 30px rgba(0,0,0,0.35),inset 0 1px 0 rgba(255,255,255,0.08);cursor:pointer;padding:0;&:disabled{opacity:0.6;cursor:not-allowed;}"]),tU=a.ZP.div.withConfig({componentId:"sc-308f91e0-3"})(["position:absolute;inset:-1px;border-radius:999px;pointer-events:none;background:radial-gradient(120px 60px at 20% 30%,rgba(34,211,238,0.25),transparent 60%),radial-gradient(140px 70px at 80% 70%,rgba(168,85,247,0.25),transparent 60%);filter:blur(10px);opacity:",";transition:opacity 200ms ease;"],e=>e.$on?1:.4),tq=(0,a.ZP)(Y.E.div).withConfig({componentId:"sc-308f91e0-4"})(["position:absolute;top:5px;left:5px;width:24px;height:24px;border-radius:999px;background:",";border:1px solid rgba(255,255,255,0.18);box-shadow:0 10px 22px rgba(0,0,0,0.4),inset 0 1px 0 rgba(255,255,255,0.10);"],e=>e.$on?"linear-gradient(135deg, rgba(34, 211, 238, 0.55), rgba(168, 85, 247, 0.42))":"rgba(255, 255, 255, 0.18)"),tH=e=>{let{className:t}=e,{architectMode:n,setArchitectMode:i,isGenerating:a,isPlanning:o}=U();return(0,r.jsxs)(tD,{className:t,children:[(0,r.jsx)(t_,{children:"Architect Mode"}),(0,r.jsxs)(tW,{type:"button","aria-label":"Architect Mode","aria-pressed":n,onClick:()=>i(!n),disabled:a||o,children:[(0,r.jsx)(tU,{$on:n}),(0,r.jsx)(tq,{$on:n,animate:{x:n?20:0},transition:{type:"spring",stiffness:500,damping:34}})]})]})};var tG=n(6744),tB=n(9234),tX=n(8146),tJ=n(384);let tY=(0,a.F4)(["0%{transform:translateX(-60%) rotate(12deg);opacity:0.0;}30%{opacity:0.9;}100%{transform:translateX(120%) rotate(12deg);opacity:0.0;}"]),tV=(0,a.ZP)(Y.E.button).withConfig({componentId:"sc-3ea77b-0"})(["position:relative;height:46px;padding:0 18px;border-radius:16px;border:1px solid rgba(255,255,255,0.16);background:rgba(255,255,255,0.05);color:rgba(255,255,255,0.92);font-weight:900;letter-spacing:0.04em;text-transform:uppercase;display:flex;align-items:center;justify-content:center;gap:8px;cursor:pointer;user-select:none;backdrop-filter:blur(16px);box-shadow:0 18px 40px rgba(0,0,0,0.45),0 0 0 1px rgba(0,0,0,0.2) inset,inset 0 1px 0 rgba(255,255,255,0.12);overflow:hidden;&:disabled{opacity:0.6;cursor:not-allowed;filter:grayscale(0.2);}&::before{content:'';position:absolute;inset:-1px;background:",";opacity:0.95;filter:blur(12px);pointer-events:none;}"],e=>"planning"===e.$state?"radial-gradient(140px 60px at 18% 40%, rgba(168, 85, 247, 0.30), transparent 70%),\n          radial-gradient(140px 60px at 82% 60%, rgba(34, 211, 238, 0.22), transparent 70%)":"coding"===e.$state?"radial-gradient(140px 60px at 18% 40%, rgba(34, 211, 238, 0.30), transparent 70%),\n          radial-gradient(140px 60px at 82% 60%, rgba(250, 204, 21, 0.18), transparent 70%)":"done"===e.$state?"radial-gradient(140px 60px at 18% 40%, rgba(34, 197, 94, 0.26), transparent 70%),\n          radial-gradient(140px 60px at 82% 60%, rgba(168, 85, 247, 0.18), transparent 70%)":"radial-gradient(140px 60px at 18% 40%, rgba(34, 211, 238, 0.26), transparent 70%),\n        radial-gradient(140px 60px at 82% 60%, rgba(168, 85, 247, 0.22), transparent 70%)"),tK=a.ZP.div.withConfig({componentId:"sc-3ea77b-1"})(["position:absolute;inset:0;pointer-events:none;opacity:",";transition:opacity 200ms ease;&::after{content:'';position:absolute;top:-40%;left:-30%;width:45%;height:180%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.30),transparent);filter:blur(2px);animation:"," 1.35s linear infinite;}"],e=>e.$active?1:0,tY),tQ=a.ZP.span.withConfig({componentId:"sc-3ea77b-2"})(["position:relative;z-index:1;display:inline-flex;align-items:center;gap:8px;white-space:nowrap;"]),t0=a.ZP.span.withConfig({componentId:"sc-3ea77b-3"})(["display:inline-grid;grid-template-areas:'stack';align-items:center;min-width:fit-content;"]),t5=(0,a.ZP)(t0).withConfig({componentId:"sc-3ea77b-4"})(["width:20px;height:20px;min-width:20px;& svg{width:20px;height:20px;min-width:20px;}"]),t2=a.ZP.span.withConfig({componentId:"sc-3ea77b-5"})(["grid-area:stack;display:inline-flex;align-items:center;justify-content:center;opacity:",";transform:scale(",");transition:opacity 160ms ease,transform 160ms ease;pointer-events:none;"],e=>e.$visible?1:0,e=>e.$visible?1:.92),t1=e=>"planning"===e?220:"coding"===e?180:"done"===e?160:170,t8=e=>{let{state:t,disabled:n,onClick:i,className:a}=e,o="planning"===t||"coding"===t;return(0,r.jsxs)(tV,{className:a,type:"button",onClick:i,disabled:n||o,"aria-busy":o,"aria-label":"planning"===t?"Architecting":"coding"===t?"Coding":"done"===t?"Fix or edit":"Generate",$state:t,layout:!0,animate:{width:t1(t)},whileHover:n||o?void 0:{scale:1.02},whileTap:n||o?void 0:{scale:.98},transition:{type:"spring",stiffness:420,damping:30},children:[(0,r.jsx)(tK,{$active:!n&&!o}),(0,r.jsxs)(tQ,{children:[(0,r.jsxs)(t5,{"aria-hidden":"true",children:[(0,r.jsx)(t2,{$visible:"idle"===t,children:(0,r.jsx)(tG.Z,{size:18})}),(0,r.jsx)(t2,{$visible:"planning"===t,children:(0,r.jsx)(tB.Z,{size:18})}),(0,r.jsx)(t2,{$visible:"coding"===t,children:(0,r.jsx)(tX.Z,{size:18,className:"animate-spin"})}),(0,r.jsx)(t2,{$visible:"done"===t,children:(0,r.jsx)(tJ.Z,{size:18})})]}),(0,r.jsxs)(t0,{"aria-hidden":"true",children:[(0,r.jsx)(t2,{$visible:"idle"===t,children:"Generate"}),(0,r.jsx)(t2,{$visible:"planning"===t,children:"Architecting…"}),(0,r.jsx)(t2,{$visible:"coding"===t,children:"Coding…"}),(0,r.jsx)(t2,{$visible:"done"===t,children:"Fix / Edit"})]})]})]})};var t4=n(4242);let t6=a.ZP.div.withConfig({componentId:"sc-aff7789c-0"})(["height:100%;display:flex;flex-direction:column;border-radius:18px;border:1px solid rgba(255,255,255,0.12);background:rgba(255,255,255,0.04);backdrop-filter:blur(18px);box-shadow:0 22px 60px rgba(0,0,0,0.55),inset 0 1px 0 rgba(255,255,255,0.10);overflow:hidden;"]),t9=a.ZP.div.withConfig({componentId:"sc-aff7789c-1"})(["height:44px;display:flex;align-items:center;padding:0 12px;gap:10px;border-bottom:1px solid rgba(255,255,255,0.10);background:rgba(13,17,23,0.35);"]),t3=a.ZP.div.withConfig({componentId:"sc-aff7789c-2"})(["display:inline-flex;align-items:center;gap:7px;"]),t7=a.ZP.span.withConfig({componentId:"sc-aff7789c-3"})(["width:10px;height:10px;border-radius:999px;background:",";box-shadow:0 0 0 1px rgba(0,0,0,0.35) inset;"],e=>e.$color),ne=a.ZP.div.withConfig({componentId:"sc-aff7789c-4"})(["flex:1;color:rgba(255,255,255,0.70);font-size:12px;letter-spacing:0.08em;text-transform:uppercase;"]),nt=a.ZP.a.withConfig({componentId:"sc-aff7789c-5"})(["display:inline-flex;align-items:center;gap:6px;padding:7px 10px;border-radius:12px;border:1px solid rgba(255,255,255,0.12);background:rgba(255,255,255,0.05);color:rgba(255,255,255,0.78);font-size:12px;text-decoration:none;transition:background 160ms ease,border-color 160ms ease;&:hover{background:rgba(255,255,255,0.08);border-color:rgba(34,211,238,0.24);color:rgba(255,255,255,0.92);}"]),nn=a.ZP.div.withConfig({componentId:"sc-aff7789c-6"})(["position:relative;flex:1;background:#0b0f14;"]),nr=a.ZP.iframe.withConfig({componentId:"sc-aff7789c-7"})(["width:100%;height:100%;border:0;background:white;"]),ni=(0,a.ZP)(Y.E.div).withConfig({componentId:"sc-aff7789c-8"})(["position:absolute;inset:0;display:grid;place-items:center;background:radial-gradient(800px 400px at 30% 20%,rgba(34,211,238,0.10),transparent 60%),radial-gradient(800px 400px at 70% 80%,rgba(168,85,247,0.10),transparent 60%),rgba(13,17,23,0.72);color:rgba(255,255,255,0.82);font-size:14px;"]),na=e=>{let{className:t}=e,{previewUrl:n,runtimeStatus:a,runtimeMessage:o}=H(),{files:s}=f(),l=0===s.length,c=(0,i.useMemo)(()=>{let e=s.find(e=>(e.path||e.name||"").toLowerCase().endsWith("index.html"));return(null==e?void 0:e.content)||""},[s]).trim().length>10,d=!!n&&c,p=!d||"ready"!==a,g=(0,i.useMemo)(()=>"error"===a?o||"Runtime error. Check logs.":o||(d?"Booting container...":"Waiting for Code..."),[d,o,a]);return l?(0,r.jsxs)(t6,{className:t,children:[(0,r.jsxs)(t9,{children:[(0,r.jsxs)(t3,{children:[(0,r.jsx)(t7,{$color:"#ff5f57"}),(0,r.jsx)(t7,{$color:"#febc2e"}),(0,r.jsx)(t7,{$color:"#28c840"})]}),(0,r.jsx)(ne,{children:"Live Preview"})]}),(0,r.jsx)(nn,{children:(0,r.jsx)(ni,{initial:{opacity:0},animate:{opacity:1},children:"Waiting for Code..."})})]}):(0,r.jsxs)(t6,{className:t,children:[(0,r.jsxs)(t9,{children:[(0,r.jsxs)(t3,{children:[(0,r.jsx)(t7,{$color:"#ff5f57"}),(0,r.jsx)(t7,{$color:"#febc2e"}),(0,r.jsx)(t7,{$color:"#28c840"})]}),(0,r.jsx)(ne,{children:"Live Preview"}),n&&(0,r.jsxs)(nt,{href:n,target:"_blank",rel:"noopener noreferrer",children:[(0,r.jsx)(t4.Z,{size:14}),"Open"]})]}),(0,r.jsxs)(nn,{children:[p&&(0,r.jsx)(ni,{initial:{opacity:0},animate:{opacity:1},children:(0,r.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:10},children:["idle"!==a&&"ready"!==a&&(0,r.jsx)(tX.Z,{size:18,className:"animate-spin"}),g]})}),d&&(0,r.jsx)(nr,{src:null!=n?n:void 0,className:"w-full h-full border-none bg-white",sandbox:"allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts allow-downloads",allow:"cross-origin-isolated; clipboard-read; clipboard-write",title:"Live Preview"})]})]})};var no=n(5730),ns=n(8134);let nl=(0,a.ZP)(Y.E.div).withConfig({componentId:"sc-5012e058-0"})(["position:fixed;left:0;right:0;bottom:0;--console-open-height:30vh;height:",";border-top:1px solid rgba(255,255,255,0.12);background:rgba(0,0,0,0.8);box-shadow:0 -22px 60px rgba(0,0,0,0.65);overflow:hidden;z-index:50;@media (max-width:768px){--console-open-height:50vh;left:0;right:0;bottom:0;border-radius:0;border-top:1px solid rgba(255,255,255,0.12);}"],e=>e.$open?"var(--console-open-height)":"44px"),nc=a.ZP.button.withConfig({componentId:"sc-5012e058-1"})(["width:100%;height:44px;display:flex;align-items:center;gap:10px;padding:0 12px;border:0;cursor:pointer;background:rgba(0,0,0,0.8);border-bottom:1px solid rgba(255,255,255,0.12);color:var(--primary-color);letter-spacing:0.12em;text-transform:uppercase;font-size:12px;"]),nd=a.ZP.div.withConfig({componentId:"sc-5012e058-2"})(['position:relative;height:calc(var(--console-open-height) - 44px);overflow:auto;padding:12px;font-family:"JetBrains Mono","Fira Code",ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:12px;line-height:1.5;color:var(--primary-color);white-space:pre-wrap;background:rgba(0,0,0,0.8);']),np=(0,a.F4)(["50%{opacity:0.0;}"]),ng=(0,a.iv)(["animation:"," 1.1s steps(1,end) infinite;"],np),nh=a.ZP.span.withConfig({componentId:"sc-5012e058-3"})(["display:inline-block;width:9px;height:14px;background:var(--primary-color);margin-left:6px;transform:translateY(2px);",""],ng),nu=a.ZP.div.withConfig({componentId:"sc-5012e058-4"})(["color:var(--primary-color);opacity:0.55;"]),nx=a.ZP.span.withConfig({componentId:"sc-5012e058-5"})(["color:var(--primary-color);"]),nf=e=>{let{visible:t,open:n,onToggle:a,health:o,thought:s,status:l,error:c,logs:d,canFixResume:p,onFixResume:g}=e,h=(0,i.useRef)(null);(0,i.useEffect)(()=>{var e;n&&(null===(e=h.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))},[c,d,n,l,s]);let u=(0,i.useMemo)(()=>eA((s||"").trim()),[s]),x=(0,i.useMemo)(()=>eA((d||"").trim()),[d]),f=(0,i.useMemo)(()=>eA((c||"").trim()),[c]),m=(0,i.useMemo)(()=>eA((l||"").trim()),[l]),b=(0,i.useMemo)(()=>eA((o||"").trim()),[o]),w=b.startsWith("OK")?"rgba(34,197,94,0.92)":0===b.length?"rgba(255,255,255,0.55)":"rgba(250,204,21,0.92)";return(0,r.jsx)(V.M,{children:t&&(0,r.jsxs)(nl,{$open:n,initial:{opacity:0,y:24},animate:{opacity:1,y:0},exit:{opacity:0,y:24},transition:{type:"spring",stiffness:380,damping:32},children:[(0,r.jsxs)(nc,{type:"button",onClick:a,"aria-expanded":n,children:[(0,r.jsx)(no.Z,{size:16}),"System Console",(0,r.jsx)("span",{style:{marginLeft:"auto",opacity:.8},children:n?(0,r.jsx)(eo.Z,{size:16}):(0,r.jsx)(ns.Z,{size:16})})]}),n&&(0,r.jsxs)(nd,{children:[b.length>0&&(0,r.jsxs)("div",{style:{marginBottom:6,color:w},children:[(0,r.jsx)(nx,{children:"[HEALTH]"})," ",(0,r.jsx)("span",{children:b})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(nx,{children:"[STATUS]"})," ",(0,r.jsx)("span",{children:m||"Idle"})]}),f.length>0&&(0,r.jsxs)("div",{style:{marginTop:8,color:"rgba(248,113,113,0.95)"},children:[(0,r.jsx)(nx,{children:"[ERROR]"})," ",(0,r.jsx)("span",{children:f})]}),p&&g&&(0,r.jsx)("div",{style:{marginTop:10},children:(0,r.jsx)("button",{type:"button",onClick:g,style:{borderRadius:10,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(255,255,255,0.08)",color:"rgba(255,255,255,0.88)",padding:"8px 10px",cursor:"pointer",fontWeight:800},children:"Fix & Resume"})}),(0,r.jsxs)("div",{style:{marginTop:10},children:[(0,r.jsx)(nx,{children:"[THOUGHT]"})," ",0===u.length?(0,r.jsx)(nu,{children:"Reasoning not available."}):(0,r.jsx)("span",{children:u}),(0,r.jsx)(nh,{})]}),x.length>0&&(0,r.jsx)("div",{style:{marginTop:12,opacity:.92},children:x}),(0,r.jsx)("div",{ref:h})]})]})})};var nm=n(9901),nb=n(7329),nw=n(2819);let nv=(0,a.F4)(["0%{box-shadow:0 0 0 1px rgba(59,130,246,0.45),0 0 18px rgba(59,130,246,0.18);}50%{box-shadow:0 0 0 1px rgba(59,130,246,0.75),0 0 26px rgba(59,130,246,0.35);}100%{box-shadow:0 0 0 1px rgba(59,130,246,0.45),0 0 18px rgba(59,130,246,0.18);}"]),ny=(0,a.F4)(["0%{background-position:0% 50%;}100%{background-position:180% 50%;}"]),nj=(0,a.F4)(["0%{transform:translateX(-60%);opacity:0;}20%{opacity:0.55;}100%{transform:translateX(160%);opacity:0;}"]),nk=(0,a.F4)(["0%{opacity:0.85;filter:saturate(1.0);}50%{opacity:1;filter:saturate(1.15);}100%{opacity:0.85;filter:saturate(1.0);}"]),nC=(0,a.iv)(["border-color:rgba(255,255,255,0.16);opacity:0.6;"]),nP=(0,a.iv)(["border-color:rgba(59,130,246,0.6);animation:"," 1.6s ease-in-out infinite;"],nv),nS=(0,a.iv)(["border-color:rgba(34,197,94,0.7);box-shadow:0 0 20px rgba(34,197,94,0.22);"]),nI=a.ZP.div.withConfig({componentId:"sc-61e4e2aa-0"})(["height:100%;display:flex;flex-direction:column;border-radius:18px;border:1px solid rgba(255,255,255,0.10);background:rgba(255,255,255,0.05);backdrop-filter:blur(24px);box-shadow:0 22px 60px rgba(0,0,0,0.55),inset 0 1px 0 rgba(255,255,255,0.10);overflow:hidden;"]),nZ=a.ZP.div.withConfig({componentId:"sc-61e4e2aa-1"})(["height:44px;display:flex;align-items:center;gap:10px;padding:0 12px;border-bottom:1px solid rgba(255,255,255,0.10);color:rgba(255,255,255,0.78);letter-spacing:0.10em;text-transform:uppercase;font-size:12px;font-weight:800;"]),nE=a.ZP.div.withConfig({componentId:"sc-61e4e2aa-2"})(["flex:1;min-height:0;overflow:auto;padding:12px;display:flex;flex-direction:column;gap:14px;"]),nT=a.ZP.div.withConfig({componentId:"sc-61e4e2aa-3"})(["max-height:400px;overflow-y:auto;"]),nN=a.ZP.div.withConfig({componentId:"sc-61e4e2aa-4"})(["height:100%;display:grid;place-items:center;color:rgba(255,255,255,0.50);font-size:13px;text-align:center;padding:18px;"]),nF=a.ZP.div.withConfig({componentId:"sc-61e4e2aa-5"})(["height:4px;border-radius:999px;background:rgba(255,255,255,0.10);overflow:hidden;"]),nz=a.ZP.div.withConfig({componentId:"sc-61e4e2aa-6"})(["height:100%;width:",";position:relative;background:linear-gradient( 90deg,rgba(34,211,238,0.92),rgba(168,85,247,0.88),rgba(34,211,238,0.92) );background-size:220% 100%;animation:"," 2.2s linear infinite,"," 2.6s ease-in-out infinite;transition:width 240ms ease;&::after{content:'';position:absolute;top:-2px;bottom:-2px;left:0;width:55%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.35),transparent);filter:blur(2px);animation:"," 1.5s linear infinite;opacity:0.22;pointer-events:none;}"],e=>"".concat(Math.round(100*e.$pct),"%"),ny,nk,nj),nA=a.ZP.div.withConfig({componentId:"sc-61e4e2aa-7"})(["display:flex;justify-content:space-between;font-size:11px;font-weight:800;letter-spacing:0.12em;text-transform:uppercase;color:rgba(255,255,255,0.6);"]),nM=a.ZP.div.withConfig({componentId:"sc-61e4e2aa-8"})(["display:grid;gap:10px;"]),nL=a.ZP.div.withConfig({componentId:"sc-61e4e2aa-9"})(["font-size:11px;font-weight:800;letter-spacing:0.14em;text-transform:uppercase;color:rgba(255,255,255,0.6);"]),nR=a.ZP.div.withConfig({componentId:"sc-61e4e2aa-10"})(["font-size:12px;color:rgba(255,255,255,0.4);border:1px dashed rgba(255,255,255,0.12);border-radius:12px;padding:10px;text-align:center;"]),n$=(0,a.ZP)(Y.E.div).withConfig({componentId:"sc-61e4e2aa-11"})(["display:grid;grid-template-columns:24px 1fr auto;gap:12px;align-items:center;padding:12px;border-radius:14px;border:1px solid rgba(255,255,255,0.12);background:rgba(255,255,255,0.035);backdrop-filter:blur(18px);color:rgba(255,255,255,0.86);"," "," ",""],e=>"pending"===e.$status&&nC,e=>"active"===e.$status&&nP,e=>"done"===e.$status&&nS),nO=a.ZP.div.withConfig({componentId:"sc-61e4e2aa-12"})(["font-size:13px;font-weight:700;line-height:1.3;color:rgba(255,255,255,0.9);"]),nD=a.ZP.div.withConfig({componentId:"sc-61e4e2aa-13"})(["font-size:11px;font-weight:700;letter-spacing:0.08em;text-transform:uppercase;color:",";"],e=>"active"===e.$status?"rgba(59, 130, 246, 0.95)":"done"===e.$status?"rgba(34, 197, 94, 0.95)":"rgba(255, 255, 255, 0.45)"),n_=a.ZP.div.withConfig({componentId:"sc-61e4e2aa-14"})(["display:grid;gap:4px;"]),nW=["frontend","ui","client","component","layout","style","design","page","view","ux","css","react","vite","svelte","vue"],nU=["backend","api","server","database","db","auth","route","controller","model","endpoint","express","flask","fastapi","node","python"],nq=e=>{let t=e.toLowerCase();return nU.some(e=>t.includes(e))?"backend":(nW.some(e=>t.includes(e)),"frontend")},nH=e=>{let{items:t,currentStepId:n,embedded:a=!1,className:o}=e,s=t.length,l=t.filter(e=>e.completed).length,c=(0,i.useMemo)(()=>{let e=[],n=[];for(let r of t)"backend"===nq(r.title)?n.push(r):e.push(r);return{frontend:e,backend:n}},[t]),d=e=>{let t=n===e.id&&!e.completed,i=e.completed?"done":t?"active":"pending",a="pending"===i?"Pending":"active"===i?"Working":"Done";return(0,r.jsxs)(n$,{$status:i,initial:{opacity:0,y:6},animate:{opacity:1,y:0},children:["done"===i?(0,r.jsx)(nm.Z,{size:20,color:"rgba(34, 197, 94, 0.95)"}):"active"===i?(0,r.jsx)(nb.Z,{size:20,color:"rgba(59, 130, 246, 0.95)"}):(0,r.jsx)(nw.Z,{size:20,color:"rgba(255, 255, 255, 0.4)"}),(0,r.jsxs)(n_,{children:[(0,r.jsx)(nO,{children:e.title}),"active"===i&&(0,r.jsx)(nD,{$status:i,children:"Working..."})]}),(0,r.jsx)(nD,{$status:i,children:a})]},e.id)},p=(0,r.jsxs)(r.Fragment,{children:[s>0&&(0,r.jsxs)("div",{style:{display:"grid",gap:8},children:[(0,r.jsxs)(nA,{children:[(0,r.jsx)("span",{children:"Mission Progress"}),(0,r.jsxs)("span",{children:[l,"/",s]})]}),(0,r.jsx)(nF,{"aria-hidden":"true",children:(0,r.jsx)(nz,{$pct:s>0?l/s:0})})]}),0===s?(0,r.jsx)(nN,{children:"Click “Plan” to generate a step-by-step mission."}):(0,r.jsxs)(nT,{className:"scrollbar-thin scrollbar-glass plan-container",children:[(0,r.jsxs)(nM,{children:[(0,r.jsx)(nL,{children:"Frontend Architecture"}),0===c.frontend.length?(0,r.jsx)(nR,{children:"No frontend tasks yet."}):c.frontend.map(d)]}),(0,r.jsxs)(nM,{children:[(0,r.jsx)(nL,{children:"Backend Logic"}),0===c.backend.length?(0,r.jsx)(nR,{children:"No backend tasks yet."}):c.backend.map(d)]})]})]});return a?(0,r.jsx)("div",{className:o,style:{height:"100%",minHeight:0,overflow:"hidden"},children:(0,r.jsx)(nE,{children:p})}):(0,r.jsxs)(nI,{className:o,children:[(0,r.jsx)(nZ,{children:"Mission Control"}),(0,r.jsx)(nE,{children:p})]})};var nG=n(457);let nB=(0,i.createContext)(null),nX=a.ZP.div.withConfig({componentId:"sc-7c92816-0"})(["position:relative;display:inline-flex;"]),nJ=a.ZP.div.withConfig({componentId:"sc-7c92816-1"})(["position:fixed;left:",";top:",";transform:translateX(-50%) translateY(",");opacity:",";pointer-events:",";transition:opacity 160ms ease,transform 160ms ease;z-index:9999;"],e=>"".concat(e.$left,"px"),e=>"".concat(e.$top,"px"),e=>e.$open?"0px":"bottom"===e.$placement?"-6px":"6px",e=>e.$open?1:0,e=>e.$open?"auto":"none"),nY=a.ZP.div.withConfig({componentId:"sc-7c92816-2"})(["width:280px;border-radius:16px;border:1px solid rgba(255,255,255,0.14);background:rgba(13,17,23,0.72);backdrop-filter:blur(18px);box-shadow:0 22px 60px rgba(0,0,0,0.62),inset 0 1px 0 rgba(255,255,255,0.08);padding:12px 12px 11px;"]),nV=a.ZP.div.withConfig({componentId:"sc-7c92816-3"})(["position:absolute;left:50%;"," width:12px;height:12px;transform:translateX(-50%) rotate(45deg);background:rgba(13,17,23,0.72);border-left:1px solid rgba(255,255,255,0.14);border-top:1px solid rgba(255,255,255,0.14);"],e=>"bottom"===e.$placement?"top: -6px;":"bottom: -6px;"),nK=a.ZP.div.withConfig({componentId:"sc-7c92816-4"})(["font-weight:900;letter-spacing:0.10em;text-transform:uppercase;font-size:11px;color:rgba(255,255,255,0.78);"]),nQ=a.ZP.div.withConfig({componentId:"sc-7c92816-5"})(["margin-top:8px;font-size:12px;line-height:1.45;color:rgba(255,255,255,0.68);"]),n0=a.ZP.span.withConfig({componentId:"sc-7c92816-6"})(["display:inline-flex;"]),n5=()=>{if("undefined"==typeof document)return null;let e=document.getElementById("overlay-root");if(e)return e;let t=document.createElement("div");return t.id="overlay-root",document.body.appendChild(t),t},n2=e=>{let{children:t,openDelayMs:n=80,closeDelayMs:a=80}=e,[o,s]=(0,i.useState)(!1),[l,c]=(0,i.useState)(null),d=(0,i.useRef)(null),p=(0,i.useRef)(null),g=()=>{d.current&&window.clearTimeout(d.current),p.current&&window.clearTimeout(p.current),d.current=null,p.current=null},h=()=>{g(),s(!0)},u=()=>{g(),d.current=window.setTimeout(()=>s(!0),n)},x=()=>{g(),p.current=window.setTimeout(()=>s(!1),a)},f=(0,i.useMemo)(()=>({open:o,setOpen:s,openNow:h,scheduleOpen:u,scheduleClose:x,triggerEl:l,setTriggerEl:c}),[o,l]);return(0,r.jsx)(nB.Provider,{value:f,children:(0,r.jsx)(nX,{children:t})})},n1=e=>{let{children:t}=e,n=(0,i.useContext)(nB);if(!n)throw Error("InstructionPopover.Trigger must be used within <Popover>.");return(0,r.jsx)(n0,{ref:e=>n.setTriggerEl(e),onMouseEnter:n.scheduleOpen,onMouseLeave:n.scheduleClose,onFocusCapture:n.openNow,onBlurCapture:e=>{let t=e.relatedTarget;t&&e.currentTarget.contains(t)||n.setOpen(!1)},children:t})},n8=e=>{let{children:t}=e,n=(0,i.useContext)(nB);if(!n)throw Error("InstructionPopover.Content must be used within <Popover>.");let a=(0,i.useMemo)(()=>n5(),[]),o=(0,i.useRef)(null),[s,l]=(0,i.useState)({left:0,top:0,placement:"bottom"});return((0,i.useLayoutEffect)(()=>{if(!n.open||!n.triggerEl||!o.current)return;let e=()=>{if(!n.triggerEl||!o.current)return;let e=n.triggerEl.getBoundingClientRect(),t=o.current.getBoundingClientRect(),r=Math.min(Math.max(e.left+e.width/2,10+t.width/2),window.innerWidth-10-t.width/2),i=e.bottom+10,a=i+t.height<=window.innerHeight-10,s=e.top-10-t.height,c=a||!(s>=10)?"bottom":"top";l({left:r,top:"bottom"===c?i:Math.max(10,s),placement:c})};e();let t=()=>e();return window.addEventListener("resize",e),window.addEventListener("scroll",t,!0),()=>{window.removeEventListener("resize",e),window.removeEventListener("scroll",t,!0)}},[n.open,n.triggerEl]),a)?(0,nG.createPortal)((0,r.jsx)(nJ,{$open:n.open,$left:s.left,$top:s.top,$placement:s.placement,role:"tooltip",onMouseEnter:n.openNow,onMouseLeave:n.scheduleClose,children:(0,r.jsxs)(nY,{ref:o,children:[(0,r.jsx)(nV,{$placement:s.placement}),t]})}),a):null},n4=e=>{let{children:t}=e;return(0,r.jsx)(nK,{children:t})},n6=e=>{let{children:t}=e;return(0,r.jsx)(nQ,{children:t})},n9=(0,a.vJ)(["::-webkit-scrollbar{width:8px;height:8px;}::-webkit-scrollbar-track{background:rgba(0,0,0,0.2);}::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.15);border-radius:4px;}::-webkit-scrollbar-thumb:hover{background:rgba(255,255,255,0.25);}.scrollbar-thin{scrollbar-width:thin;scrollbar-color:rgba(255,255,255,0.22) rgba(0,0,0,0.18);}.scrollbar-thin::-webkit-scrollbar{width:6px;height:6px;}.scrollbar-glass::-webkit-scrollbar-track{background:rgba(0,0,0,0.18);border-radius:999px;}.scrollbar-glass::-webkit-scrollbar-thumb{background:linear-gradient(180deg,rgba(255,255,255,0.18),rgba(255,255,255,0.10));border:1px solid rgba(255,255,255,0.10);border-radius:999px;}.scrollbar-glass::-webkit-scrollbar-thumb:hover{background:linear-gradient(180deg,rgba(34,211,238,0.22),rgba(168,85,247,0.18));border-color:rgba(255,255,255,0.14);}"]),n3=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-0"})(["width:100%;height:100%;overflow:hidden;position:relative;background:radial-gradient(900px 500px at 20% 10%,rgba(34,211,238,0.12),transparent 55%),radial-gradient(900px 500px at 80% 85%,rgba(168,85,247,0.12),transparent 55%),#0d1117;color:rgba(255,255,255,0.92);"]),n7=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-1"})(["height:100%;overflow:hidden;display:flex;flex-direction:column;gap:12px;padding:14px;min-height:0;@media (max-width:768px){padding-bottom:190px;}"]),re=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-2"})(["flex-shrink:0;height:44px;display:flex;align-items:center;justify-content:space-between;gap:12px;"]),rt=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-3"})(["min-width:0;display:flex;align-items:center;gap:10px;"]),rn=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-4"})(["display:flex;align-items:center;gap:10px;"]),rr=a.ZP.button.withConfig({componentId:"sc-9ee69c7a-5"})(["width:44px;height:44px;display:grid;place-items:center;border-radius:14px;border:1px solid rgba(255,255,255,0.10);background:rgba(255,255,255,0.04);color:rgba(255,255,255,0.86);cursor:pointer;transition:background 160ms ease,border-color 160ms ease,transform 160ms ease;&:hover{background:rgba(255,255,255,0.06);border-color:rgba(255,255,255,0.16);transform:translateY(-1px);}"]),ri=a.ZP.button.withConfig({componentId:"sc-9ee69c7a-6"})(["position:fixed;inset:0;border:0;padding:0;margin:0;background:rgba(0,0,0,0.55);backdrop-filter:blur(10px);opacity:",";pointer-events:",";transition:opacity 160ms ease;z-index:55;"],e=>e.$open?1:0,e=>e.$open?"auto":"none"),ra=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-7"})(["position:fixed;top:70px;right:18px;width:min(420px,calc(100vw - 36px));max-height:calc(100vh - 140px);border-radius:18px;border:1px solid rgba(255,255,255,0.12);background:rgba(10,10,10,0.55);backdrop-filter:blur(22px);box-shadow:0 22px 60px rgba(0,0,0,0.55),inset 0 1px 0 rgba(255,255,255,0.08);overflow:hidden;transform:",";opacity:",";pointer-events:",";transition:opacity 180ms ease,transform 180ms ease;z-index:56;"],e=>e.$open?"translateY(0)":"translateY(-10px)",e=>e.$open?1:0,e=>e.$open?"auto":"none"),ro=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-8"})(["height:44px;display:flex;align-items:center;justify-content:space-between;padding:0 12px;border-bottom:1px solid rgba(255,255,255,0.10);letter-spacing:0.12em;text-transform:uppercase;font-size:12px;font-weight:900;color:rgba(255,255,255,0.82);"]),rs=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-9"})(["height:calc(100% - 44px);overflow:hidden;"]),rl=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-10"})(["position:fixed;right:18px;bottom:62px;width:min(360px,calc(100vw - 36px));max-height:48vh;z-index:54;",""],e=>!e.$open&&"\n      width: auto;\n      max-height: none;\n    "),rc=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-11"})(["position:relative;border-radius:18px;border:1px solid rgba(255,255,255,0.10);background:rgba(255,255,255,0.05);backdrop-filter:blur(24px);box-shadow:0 22px 60px rgba(0,0,0,0.55),inset 0 1px 0 rgba(255,255,255,0.08);overflow:hidden;&::before{content:'';position:absolute;inset:-60px;background:radial-gradient(220px 120px at 20% 20%,rgba(34,211,238,0.16),transparent 60%),radial-gradient(240px 140px at 80% 60%,rgba(168,85,247,0.14),transparent 60%);filter:blur(18px);opacity:0.8;pointer-events:none;}"]),rd=a.ZP.button.withConfig({componentId:"sc-9ee69c7a-12"})(["position:relative;z-index:1;width:100%;height:42px;padding:0 12px;display:flex;align-items:center;gap:10px;justify-content:space-between;border:0;cursor:pointer;background:rgba(0,0,0,0.10);border-bottom:1px solid rgba(255,255,255,0.08);color:rgba(255,255,255,0.84);letter-spacing:0.10em;text-transform:uppercase;font-size:12px;font-weight:900;"]),rp=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-13"})(["position:relative;z-index:1;height:calc(48vh - 42px);max-height:calc(48vh - 42px);overflow:hidden;"]),rg=a.ZP.button.withConfig({componentId:"sc-9ee69c7a-14"})(["width:44px;height:44px;display:grid;place-items:center;border-radius:16px;border:1px solid rgba(255,255,255,0.12);background:rgba(255,255,255,0.05);backdrop-filter:blur(22px);color:rgba(255,255,255,0.86);cursor:pointer;box-shadow:0 18px 40px rgba(0,0,0,0.45),inset 0 1px 0 rgba(255,255,255,0.08);transition:background 160ms ease,border-color 160ms ease,transform 160ms ease;&:hover{background:rgba(255,255,255,0.07);border-color:rgba(255,255,255,0.18);transform:translateY(-1px);}"]),rh=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-15"})(["display:flex;flex-direction:column;gap:2px;line-height:1.05;"]),ru=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-16"})(["font-weight:900;letter-spacing:0.14em;text-transform:uppercase;font-size:12px;color:rgba(255,255,255,0.82);"]),rx=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-17"})(["font-size:11px;font-weight:700;letter-spacing:0.06em;color:rgba(255,255,255,0.55);"]),rf=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-18"})(["padding:7px 10px;border-radius:999px;border:1px solid rgba(255,255,255,0.14);background:rgba(255,255,255,0.05);color:",";font-size:12px;white-space:nowrap;"],e=>e.$active?"rgba(34, 211, 238, 0.92)":"rgba(255, 255, 255, 0.62)"),rm=a.ZP.button.withConfig({componentId:"sc-9ee69c7a-19"})(["display:none;width:36px;height:36px;border-radius:12px;border:1px solid rgba(255,255,255,0.14);background:rgba(255,255,255,0.05);color:rgba(255,255,255,0.8);align-items:center;justify-content:center;cursor:pointer;&:hover{border-color:rgba(168,85,247,0.22);background:rgba(255,255,255,0.08);}@media (max-width:768px){display:inline-flex;}"]),rb=a.ZP.button.withConfig({componentId:"sc-9ee69c7a-20"})(["width:36px;height:36px;border-radius:12px;border:1px solid rgba(255,255,255,0.14);background:rgba(255,255,255,0.05);color:rgba(255,255,255,0.8);display:inline-flex;align-items:center;justify-content:center;cursor:pointer;&:hover{border-color:rgba(34,211,238,0.24);background:rgba(255,255,255,0.08);}@media (max-width:768px){display:none;}"]),rw=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-21"})(["display:none;width:100%;max-width:1000px;margin:0 auto;padding:6px;border-radius:16px;border:1px solid rgba(255,255,255,0.12);background:rgba(255,255,255,0.04);backdrop-filter:blur(18px);gap:6px;@media (max-width:768px){display:flex;}"]),rv=a.ZP.button.withConfig({componentId:"sc-9ee69c7a-22"})(["flex:1;height:38px;border-radius:14px;border:1px solid ",";background:",";color:",";font-weight:900;letter-spacing:0.10em;text-transform:uppercase;font-size:11px;cursor:pointer;&:hover{border-color:rgba(168,85,247,0.22);background:rgba(255,255,255,0.05);}"],e=>e.$active?"rgba(34, 211, 238, 0.22)":"rgba(255, 255, 255, 0.08)",e=>e.$active?"rgba(34, 211, 238, 0.10)":"rgba(255, 255, 255, 0.03)",e=>e.$active?"rgba(255,255,255,0.90)":"rgba(255,255,255,0.66)"),ry=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-23"})(["flex-shrink:0;display:flex;flex-direction:column;gap:10px;align-items:center;"]),rj=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-24"})(["flex:1;min-height:0;display:grid;grid-template-columns:",";grid-template-rows:1fr;gap:14px;@media (max-width:768px){grid-template-columns:1fr;gap:0;position:relative;}"],e=>e.$previewOpen?"260px minmax(0, 1fr) minmax(0, 1fr)":"260px minmax(0, 1fr)"),rk=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-25"})(["min-height:0;min-width:0;height:100%;width:260px;flex-shrink:0;@media (max-width:768px){display:none;}"]),rC=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-26"})(["position:fixed;inset:0;background:rgba(3,6,10,0.6);opacity:",";pointer-events:",";transition:opacity 180ms ease;z-index:55;@media (min-width:769px){display:none;}"],e=>e.$open?1:0,e=>e.$open?"auto":"none"),rP=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-27"})(["position:fixed;top:0;left:0;bottom:0;width:min(340px,88vw);background:rgba(10,12,18,0.92);border-right:1px solid rgba(255,255,255,0.08);box-shadow:18px 0 40px rgba(0,0,0,0.6);transform:translateX(",");transition:transform 220ms ease;z-index:56;display:flex;flex-direction:column;padding:12px;@media (min-width:769px){display:none;}"],e=>e.$open?"0":"-100%"),rS=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-28"})(["display:flex;align-items:center;justify-content:space-between;padding:4px 4px 10px;"]),rI=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-29"})(["font-size:11px;font-weight:800;letter-spacing:0.12em;text-transform:uppercase;color:rgba(255,255,255,0.7);"]),rZ=a.ZP.button.withConfig({componentId:"sc-9ee69c7a-30"})(["width:32px;height:32px;border-radius:10px;border:1px solid rgba(255,255,255,0.12);background:rgba(255,255,255,0.04);color:rgba(255,255,255,0.7);display:inline-flex;align-items:center;justify-content:center;cursor:pointer;&:hover{border-color:rgba(168,85,247,0.22);background:rgba(255,255,255,0.08);}"]),rE=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-31"})(["min-height:0;min-width:0;height:100%;@media (min-width:769px){display:",";}@media (max-width:768px){position:absolute;inset:0;opacity:",";pointer-events:",";transition:opacity 160ms ease;}"],e=>e.$desktopHidden?"none":"block",e=>e.$mobileActive?1:0,e=>e.$mobileActive?"auto":"none"),rT=a.ZP.div.withConfig({componentId:"sc-9ee69c7a-32"})(["position:absolute;top:14px;left:50%;transform:translateX(-50%);width:min(820px,calc(100vw - 28px));padding:12px 14px;border-radius:16px;border:1px solid rgba(239,68,68,0.32);background:rgba(239,68,68,0.10);backdrop-filter:blur(18px);display:flex;align-items:flex-start;gap:10px;color:rgba(255,255,255,0.90);z-index:60;"]);var rN=function(){let{prompt:e,architectMode:t,modelMode:n,interactionMode:a,isGenerating:h,isPlanning:u,lastTokenAt:x,planSteps:m,thinkingContent:b,systemConsoleContent:w,isPreviewOpen:v,setPrompt:j,setIsGenerating:k,setInteractionMode:C,setSections:P,setStreamText:S,updateLastToken:I,clearThinkingContent:Z,appendThinkingContent:E,clearSystemConsoleContent:T,appendSystemConsoleContent:N,setPlanSteps:F,generatePlan:z,clearFileStatuses:A,setFileStatus:M,setWritingFilePath:L,resetFiles:R,resolveFilePath:$,upsertFileNode:O,appendToFileNode:D,setFilesFromProjectFiles:_,addChatMessage:W,error:q,setError:B,setIsPreviewOpen:X}=U(),{deployAndRun:J}=eB(),{files:Y,activeFile:V,projectName:K,stack:Q,description:ee,reset:et,setFiles:en,setFileStructure:er,setActiveFile:ei,updateFile:ea,upsertFile:eo,appendToFile:es,setStack:el,setDescription:ec,setProjectId:ed,setProjectName:ep}=f(),{setPreviewUrl:eg,addLog:eh,logs:eu,runtimeStatus:ex,runtimeMessage:ef}=H(),[em,eb]=(0,i.useState)(""),[ew,ev]=(0,i.useState)(!1),[ey,ej]=(0,i.useState)(!1),[ek,eC]=(0,i.useState)("editor"),[eP,eS]=(0,i.useState)(!1),[eI,eZ]=(0,i.useState)(!1),[eE,eT]=(0,i.useState)(!1),eN=(0,i.useRef)(null),eF=(0,i.useRef)(null),ez=(0,i.useRef)(new Map),eA=(0,i.useRef)(null),eM=(0,i.useRef)(null),eL=(0,i.useRef)(""),eR=(0,i.useRef)(0),e$=(0,i.useRef)(0),eO=(0,i.useRef)({signature:"",attempts:0}),eD=(0,i.useMemo)(()=>u?"planning":h?"coding":Y.length>0?"done":"idle",[Y.length,h,u]),e_=(0,i.useMemo)(()=>{var e;return null===(e=m.find(e=>!e.completed))||void 0===e?void 0:e.id},[m]),eW=(0,i.useMemo)(()=>{let e=Date.now(),t=x>0?e-x:0,n="error"!==ex;return!h||x>0&&t<8e3?n?"OK":"DEGRADED: preview ".concat(ef||"error"):"DEGRADED: stream stalled"},[h,x,ef,ex]),eU=()=>new Date().toLocaleTimeString([],{hour12:!1}),eq=(0,i.useCallback)(e=>{N("".concat(eU()," ").concat(e,"\n"))},[N]);(0,i.useEffect)(()=>{t&&0!==m.length&&eZ(!0)},[t,m.length]),(0,i.useEffect)(()=>{if(h)return;let e=!1,t=Y.map(t=>{let n=t.path||t.name||"",r=$(n)||n;return r!==n&&(e=!0),{...t,name:t.name||r.split("/").pop()||r,path:r}});if(e){if(en(t),er(t.map(e=>({path:e.path||e.name,type:"file"}))),V){let e=$(V)||V;e!==V&&ei(e)}return}_(Y)},[V,Y,h,$,ei,er,en,_]),(0,i.useEffect)(()=>{Y.length>0||"edit"!==a||C("create")},[Y.length,a,C]);let eH=(0,i.useCallback)(()=>{if(0===ez.current.size)return;let e=U.getState().writingFilePath||"";for(let[t,n]of ez.current.entries()){if(!n){ez.current.delete(t);continue}let r=t===e?120:420,i=n.length<=r?n:n.slice(0,r),a=n.length<=r?"":n.slice(r);es(t,i),D(t,i),0===a.length?ez.current.delete(t):ez.current.set(t,a)}ez.current.size>0&&!eF.current&&(eF.current=window.setTimeout(()=>{eF.current=null,eH()},24))},[es,D]),eG=(0,i.useCallback)(()=>{eF.current||(eF.current=window.setTimeout(()=>{eF.current=null,eH()},24))},[eH]),eJ=(0,i.useCallback)(()=>{eA.current||(eA.current=window.setTimeout(()=>{eA.current=null,I()},120))},[I]),eY=(0,i.useCallback)(()=>{if(0===eL.current.length)return;let e=eL.current;eL.current="",E(e)},[E]),eV=(0,i.useCallback)(()=>{eM.current||(eM.current=window.setTimeout(()=>{eM.current=null,eY()},80))},[eY]),eK=(0,i.useCallback)(async(r,i)=>{let a=(null!=r?r:e).trim();if(!a||u||h)return;U.getState().saveCurrentSession();let o=(null==i?void 0:i.skipPlanning)===!0,s=(null==i?void 0:i.preserveProjectMeta)===!0;if(t&&!o){let e=U.getState().planSteps,t=U.getState().lastPlannedPrompt;if((0===e.length||t!==a)&&await z(a),0===U.getState().planSteps.length){B("Failed to generate a plan. Try toggling Architect Mode off for direct generation.");return}}if(eO.current={signature:"",attempts:0},X(!0),k(!0),B(null),eg(null),P({}),S(""),Z(),T(),eq("[STATUS] Starting generation stream…"),eq("[webcontainer] Waiting for code generation to finish..."),ev(!1),eb("Initializing…"),eR.current=0,e$.current=Date.now(),A(),L(null),s||et(),s||R(),eF.current&&(window.clearTimeout(eF.current),eF.current=null),ez.current.clear(),eA.current&&(window.clearTimeout(eA.current),eA.current=null),eM.current&&(window.clearTimeout(eM.current),eM.current=null),eL.current="",t&&!o){let e=U.getState().planSteps;e.length>0&&F(e.map(e=>({...e,completed:!1})))}try{let e=new Map,r=new Set,i=new Map,o=null,s=()=>{try{let e=f.getState(),t={savedAt:Date.now(),projectName:e.projectName,stack:e.stack,description:e.description,activeFile:e.activeFile,files:e.files.map(e=>({name:e.name,path:e.path||e.name,content:e.content||""}))};localStorage.setItem("nexus-apex-autosave",JSON.stringify(t))}catch(e){}},l=()=>{o||(o=window.setTimeout(()=>{o=null,s()},0))},c=t=>{if(e.has(t))return e.get(t);let n=$(t)||t;return e.set(t,n),n},d=e=>{let t=String(e||"").split(/\r?\n/);for(;t.length>0;){let e=(t[t.length-1]||"").trim();if(e.includes("[[PARTIAL_FILE_CLOSED]]")||0===e.length){t.pop();continue}break}return t.join("\n")+(t.length>0?"\n":"")},p=e=>{if(e.includes("\xa9 2026 Nexus Apex | Made by NEXUS_APEX_CODING"))return e;let t="\n".concat('<footer style="text-align: center; padding: 20px; font-size: 0.8rem; color: rgba(255,255,255,0.3); border-top: 1px solid rgba(255,255,255,0.1);">\n  \xa9 2026 Nexus Apex | Made by NEXUS_APEX_CODING\n</footer>',"\n"),n=e.match(/<\/body\s*>/i);if(n&&"number"==typeof n.index){let r=n.index;return e.slice(0,r)+t+e.slice(r)}let r=e.match(/<\/html\s*>/i);if(r&&"number"==typeof r.index){let n=r.index;return e.slice(0,n)+t+e.slice(n)}return e+t},g=e=>{let t;let n=String(e||""),r=new Set(["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"]),i=[],a=/<\/?([a-zA-Z][\w:-]*)\b[^>]*>/g;for(;null!==(t=a.exec(n));){let e=t[0]||"",n=(t[1]||"").toLowerCase();if(!(!n||e.startsWith("<!--")||e.startsWith("<!")||r.has(n)||e.endsWith("/>"))){if(e.startsWith("</")){let e=i.lastIndexOf(n);-1!==e&&i.splice(e,1);continue}i.push(n)}}if(0===i.length)return n;let o=i.reverse().map(e=>"</".concat(e,">")).join("");return"".concat(n,"\n").concat(o,"\n")},h=(e,t)=>{let n=f.getState().files.find(t=>(t.path||t.name)===e);if(!n)return;let r=d(n.content||""),i=t?g(r):r,a=p(i),o=t?"".concat(a,"\n<!-- [[PARTIAL_FILE_CLOSED]] -->\n"):a;ea(e,o),O(e,o),eo({name:n.name,path:e,content:o,language:G(e)})},u=e=>{let t=String(e||""),n=[],r=0;for(;r<t.length;){let e=t.indexOf("[[SEARCH]]",r);if(-1===e)break;let i=t.indexOf("[[REPLACE]]",e);if(-1===i)break;let a=t.indexOf("[[END_EDIT]]",i);if(-1===a)break;let o=t.slice(e+10,i).replace(/^\r?\n/,"").replace(/\r?\n$/,""),s=t.slice(i+11,a).replace(/^\r?\n/,"").replace(/\r?\n$/,"");n.push({search:o,replace:s}),r=a+12}return n},x=(e,t)=>{let n=e;for(let e of t)if(e.search&&n.includes(e.search)){n=n.replace(e.search,e.replace);continue}return n},m=0,b="thinking"===n,w=!1;await y.generateCodeStream(a,e=>{eR.current+=e.length;let t=Date.now();if(t-e$.current>900){let e=Math.round(eR.current/100)/10;eq("[STATUS] Received ".concat(e,"k chars...")),e$.current=t}eJ()},(e,t)=>{let n=U.getState().writingFilePath;n&&"streaming"===e?eb("Writing ".concat(n.split("/").pop()||n,"…")):"thinking"===e?eb("Thinking…"):"streaming"===e?eb("Generating…"):"validating"===e?eb("Validating…"):"done"===e?eb("Complete"):eb(t),t&&eq("[STATUS] ".concat(t))},e=>{var t;(null==e?void 0:null===(t=e.resume)||void 0===t?void 0:t.attempt)&&eq("[STATUS] Auto-resume attempt ".concat(e.resume.attempt)),(null==e?void 0:e.raw)&&eq("[STATUS] ".concat(String(e.raw)))},e=>{var t;let n=null==e?void 0:null===(t=e.metadata)||void 0===t?void 0:t.protocol;"file-marker"===n&&eq("[STATUS] File-Marker stream finished.")},e=>{eH();let t="string"==typeof e?e:"Generation failed";B(t),eh({timestamp:Date.now(),type:"error",message:"Generation failed: ".concat(String(e))}),eq("[ERROR] ".concat(t)),k(!1),eb("")},e=>{m+=e.length,eL.current+=e,eV(),w||(w=!0,ev(!0)),b&&(m<500?eb("Thinking…"):m<2e3?eb("Deep thinking…"):eb("Reasoning…"))},()=>{eH(),eY(),k(!1),eb(""),f.getState().files.length>0&&(r.size>0?eq("[webcontainer] Code complete but partial files remain (".concat(r.size,"). Waiting for auto-resume...")):(eq("[webcontainer] Code Complete. Writing to Container..."),setTimeout(()=>{J()},0)))},{thinkingMode:b,architectMode:t,includeReasoning:b,typingMs:26,onFileEvent:e=>{let t=c(e.path||"");if(t){if("start"===e.type){let n="edit"===e.mode?"Editing":"Writing";eq("[STATUS] ".concat(n," ").concat(t,"...")),eb("Writing ".concat(t.split("/").pop()||t,"…")),M(t,"writing"),O(t);let r=t.split("/").pop()||t,a=f.getState().files.find(e=>(e.path||e.name)===t);if(a||eo({name:r,path:t,content:"",language:G(t)}),"edit"===e.mode&&i.set(t,(null==a?void 0:a.content)||""),e.append){let e=(null==a?void 0:a.content)||"",n=d(e);ea(t,n),O(t,n),eo({name:r,path:t,content:n,language:G(t)})}else eH(),ez.current.delete(t),ea(t,""),O(t,"");L(t),ei(t),eC("editor"),ev(!0);return}if("chunk"===e.type){let n=String(e.chunk||"");if(0===n.length)return;ez.current.set(t,(ez.current.get(t)||"")+n),eG();return}if("end"===e.type){if(eH(),M(t,"ready"),U.getState().writingFilePath===t&&L(null),"edit"===e.mode){var n,a;let e=null!==(a=i.get(t))&&void 0!==a?a:"",r=(null===(n=f.getState().files.find(e=>(e.path||e.name)===t))||void 0===n?void 0:n.content)||"",o=u(r);if(o.length>0){let n=x(e,o);ea(t,n),O(t,n),eo({name:t.split("/").pop()||t,path:t,content:n,language:G(t)})}}if(t.toLowerCase().endsWith(".html")&&h(t,!!e.partial),e.partial){r.add(t);let n="Stream interrupted: ".concat(t," cut at line ").concat(e.line||"?");eq("[STATUS] ".concat(n," (healed & auto-resuming)"))}else r.delete(t),eq("[STATUS] Completed ".concat(t)),l();if(U.getState().architectMode){let e=U.getState().planSteps.find(e=>!e.completed);e&&U.getState().setPlanStepCompleted(e.id,!0)}}}}})}catch(e){eH(),eY(),B((null==e?void 0:e.message)||"Failed to generate code"),k(!1),eb("")}},[t,eh,E,Z,A,J,eH,eY,z,h,u,n,e,et,R,$,eG,eV,eJ,ei,ec,B,M,er,en,_,k,X,eg,F,ed,ep,P,el,S,eb,L,ea,eo,O,eq]),eQ=(0,i.useCallback)(e=>{let t=Y.map(e=>e.path||e.name||"").filter(e=>e.length>0).sort((e,t)=>e.localeCompare(t)),n=V||t[0]||"",r=Y.find(e=>(e.path||e.name)===n),i=(null==r?void 0:r.content)||"",a=t.slice(0,220).map(e=>"- ".concat(e)).join("\n"),o=n?"[[ACTIVE_FILE: ".concat(n,"]]\n").concat(i.length<=24e3?i:"".concat(i.slice(0,24e3),"\n\n[[TRUNCATED]]"),"\n[[END_ACTIVE_FILE]]"):"[[ACTIVE_FILE: none]]";return["SYSTEM: You are editing an existing project.","CRITICAL: Output MUST be plain text only. No JSON. No markdown.","Use ONLY these markers:","  - [[EDIT_NODE: path/to/file.ext]] ... [[END_FILE]] for edits","  - [[START_FILE: path/to/file.ext]] ... [[END_FILE]] for new files","Prefer [[EDIT_NODE]] whenever possible. Do NOT repeat unchanged files.","When editing, prefer search/replace blocks instead of rewriting entire files:","  [[EDIT_NODE: path/to/file.ext]]","  [[SEARCH]]","  <exact text>","  [[REPLACE]]","  <replacement text>","  [[END_EDIT]]","  [[END_FILE]]","","USER REQUEST: ".concat(e),"","PROJECT STRUCTURE:",a,"","ACTIVE FILE (full content):",o,"","Branding rule: Ensure the Nexus Apex footer exists in the main layout (React App component or HTML page):","\xa9 2026 Nexus Apex | Made by NEXUS_APEX_CODING | Built by Matany Labs.","Output only markers + file contents. No filler."].join("\n")},[V,Y]);(0,i.useEffect)(()=>{if(!v||h||u)return;let e=eu[eu.length-1];if(!e)return;let t=String(e.message||"");if(!t.includes("TypeError"))return;let n="typeerror:".concat(t.slice(0,500)),r=eO.current.signature===n?eO.current.attempts:0;if(r>=1)return;eO.current={signature:n,attempts:r+1};let i=eu.slice(-45).map(e=>{let t=new Date(e.timestamp).toLocaleTimeString([],{hour12:!1});return"".concat(t," ").concat(e.message)}).join("\n");eq("[STATUS] Auto-fix triggered: TypeError detected."),eK(eQ(["AUTO-FIX: A TypeError appeared in the terminal/console. Fix the code so the preview runs without throwing.",t?"Error: ".concat(t):"",i?"Recent logs:\n".concat(i):""].filter(Boolean).join("\n\n")),{skipPlanning:!0,preserveProjectMeta:!0})},[eO,eQ,eK,h,u,v,eq,eu]),(0,i.useEffect)(()=>{if("error"!==ex||!v||h||u)return;let e=String(ef||"preview-error"),t=eO.current.signature===e?eO.current.attempts:0;if(t>=1)return;eO.current={signature:e,attempts:t+1};let n=eu.slice(-45).map(e=>{let t=new Date(e.timestamp).toLocaleTimeString([],{hour12:!1});return"".concat(t," ").concat(e.message)}).join("\n");eq("[STATUS] Auto-debugging: ".concat(e)),eK(eQ(["AUTO-DEBUG: The WebContainer preview failed to run. Fix the code so it starts successfully.",e?"Error: ".concat(e):"",n?"Recent logs:\n".concat(n):""].filter(Boolean).join("\n\n")),{skipPlanning:!0,preserveProjectMeta:!0})},[eO,eQ,eK,h,u,v,eq,eu,ef,ex]);let e0=(0,i.useCallback)(()=>{if("done"===eD){if("edit"!==a){C("edit"),j(""),requestAnimationFrame(()=>{var e;return null===(e=eN.current)||void 0===e?void 0:e.focus()});return}let t=e.trim();if(!t){requestAnimationFrame(()=>{var e;return null===(e=eN.current)||void 0===e?void 0:e.focus()});return}W({role:"user",content:t}),j(""),eK(eQ(t),{skipPlanning:!0,preserveProjectMeta:!0});return}eK()},[W,eQ,eK,a,eD,e,C,j]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n9,{}),(0,r.jsxs)(n3,{children:[q&&(0,r.jsxs)(rT,{children:[(0,r.jsx)(o.Z,{size:18,style:{marginTop:1,color:"rgba(248,113,113,0.95)"}}),(0,r.jsxs)("div",{style:{flex:1},children:[(0,r.jsx)("div",{style:{fontWeight:800,marginBottom:2},children:"Error"}),(0,r.jsx)("div",{style:{color:"rgba(255,255,255,0.78)",fontSize:13},children:q})]}),(0,r.jsx)("button",{type:"button",onClick:()=>{B(null)},style:{border:0,background:"transparent",color:"rgba(255,255,255,0.65)",cursor:"pointer",fontSize:16,lineHeight:1},"aria-label":"Dismiss error",children:"\xd7"})]}),(0,r.jsxs)(n7,{children:[(0,r.jsxs)(re,{children:[(0,r.jsxs)(rt,{children:[(0,r.jsxs)(rh,{children:[(0,r.jsx)(ru,{children:"NEXUS APEX"}),(0,r.jsx)(rx,{children:(null==K?void 0:K.trim())||"Untitled Project"})]}),(0,r.jsx)(rf,{$active:h,children:h?em||"Working…":"Ready"})]}),(0,r.jsxs)(rn,{children:[(0,r.jsx)(rr,{type:"button",onClick:()=>eS(e=>!e),"aria-label":eP?"Close history":"Open history",title:"History",children:(0,r.jsx)(s.Z,{size:18})}),(0,r.jsx)(rb,{type:"button",onClick:()=>X(!v),"aria-label":v?"Hide preview":"Show preview",children:v?(0,r.jsx)(l.Z,{size:18}):(0,r.jsx)(c.Z,{size:18})}),(0,r.jsx)(rm,{type:"button",onClick:()=>ej(!0),"aria-label":"Open sidebar",children:(0,r.jsx)(d.Z,{size:18})})]})]}),(0,r.jsx)(ry,{children:(0,r.jsx)(tz,{ref:eN,controls:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n2,{children:[(0,r.jsx)(n1,{children:(0,r.jsx)(tH,{})}),(0,r.jsxs)(n8,{children:[(0,r.jsx)(n4,{children:"Architect Mode"}),(0,r.jsx)(n6,{children:"Generate a step-by-step implementation plan, then execute it."})]})]}),(0,r.jsxs)(n2,{children:[(0,r.jsx)(n1,{children:(0,r.jsx)(tO,{})}),(0,r.jsxs)(n8,{children:[(0,r.jsx)(n4,{children:"Mode"}),(0,r.jsx)(n6,{children:"Switch between Fast generation and DeepSeek Reasoner “Thinking” mode."})]})]}),(0,r.jsxs)(n2,{children:[(0,r.jsx)(n1,{children:(0,r.jsx)(t8,{state:eD,onClick:e0,disabled:"idle"===eD&&!e.trim()||"done"===eD&&"edit"===a&&!e.trim()})}),(0,r.jsxs)(n8,{children:[(0,r.jsx)(n4,{children:"done"===eD?"Fix / Edit":"Generate"}),(0,r.jsx)(n6,{children:"done"===eD?"edit"===a?"Describe what you want to change and apply it with full context.":"Switch to Edit mode to apply changes with full project context.":t?"Plan then write code.":"Write code immediately."})]})]})]})})}),(0,r.jsxs)(rw,{role:"tablist","aria-label":"Workspace tabs",children:[(0,r.jsx)(rv,{type:"button",$active:"editor"===ek,onClick:()=>eC("editor"),children:"Editor"}),(0,r.jsx)(rv,{type:"button",$active:"preview"===ek,onClick:()=>eC("preview"),children:"Preview"})]}),(0,r.jsxs)(rj,{$previewOpen:v,children:[(0,r.jsx)(rk,{children:(0,r.jsx)(tu,{onOpenSettings:()=>eT(!0)})}),(0,r.jsx)(rE,{$mobileActive:"editor"===ek,children:(0,r.jsx)(eX,{showFileTree:!1})}),(0,r.jsx)(rE,{$mobileActive:"preview"===ek,$desktopHidden:!v,children:(0,r.jsx)(na,{})})]})]}),(0,r.jsx)(rC,{$open:ey,onClick:()=>ej(!1)}),(0,r.jsxs)(rP,{$open:ey,"aria-hidden":!ey,children:[(0,r.jsxs)(rS,{children:[(0,r.jsx)(rI,{children:"Workspace"}),(0,r.jsx)(rZ,{type:"button",onClick:()=>ej(!1),"aria-label":"Close sidebar",children:(0,r.jsx)(p.Z,{size:16})})]}),(0,r.jsx)(tu,{onOpenSettings:()=>eT(!0)})]}),(0,r.jsx)(ri,{$open:eP||eE,onClick:()=>{eS(!1),eT(!1)},"aria-hidden":!(eP||eE)}),(0,r.jsxs)(ra,{$open:eP,"aria-hidden":!eP,children:[(0,r.jsxs)(ro,{children:["History",(0,r.jsx)("button",{type:"button",onClick:()=>eS(!1),style:{border:0,background:"transparent",color:"rgba(255,255,255,0.70)",cursor:"pointer"},"aria-label":"Close history",children:(0,r.jsx)(p.Z,{size:16})})]}),(0,r.jsx)(rs,{children:(0,r.jsx)(tZ,{})})]}),(0,r.jsxs)(ra,{$open:eE,"aria-hidden":!eE,children:[(0,r.jsxs)(ro,{children:["Project Settings",(0,r.jsx)("button",{type:"button",onClick:()=>eT(!1),style:{border:0,background:"transparent",color:"rgba(255,255,255,0.70)",cursor:"pointer"},"aria-label":"Close project settings",children:(0,r.jsx)(p.Z,{size:16})})]}),(0,r.jsx)(rs,{children:(0,r.jsxs)("div",{style:{padding:12,display:"grid",gap:10},children:[(0,r.jsxs)("div",{style:{display:"grid",gap:6},children:[(0,r.jsx)("div",{style:{fontSize:12,fontWeight:900,letterSpacing:"0.12em",textTransform:"uppercase",opacity:.7},children:"Project Name"}),(0,r.jsx)("input",{value:K,onChange:e=>ep(e.target.value),placeholder:"My project",style:{height:40,borderRadius:12,border:"1px solid rgba(255,255,255,0.12)",background:"rgba(255,255,255,0.05)",color:"rgba(255,255,255,0.90)",padding:"0 12px",outline:"none"}})]}),(0,r.jsxs)("div",{style:{display:"grid",gap:6},children:[(0,r.jsx)("div",{style:{fontSize:12,fontWeight:900,letterSpacing:"0.12em",textTransform:"uppercase",opacity:.7},children:"Stack"}),(0,r.jsx)("input",{value:Q,onChange:e=>el(e.target.value),placeholder:"react-vite",style:{height:40,borderRadius:12,border:"1px solid rgba(255,255,255,0.12)",background:"rgba(255,255,255,0.05)",color:"rgba(255,255,255,0.90)",padding:"0 12px",outline:"none"}})]}),(0,r.jsxs)("div",{style:{display:"grid",gap:6},children:[(0,r.jsx)("div",{style:{fontSize:12,fontWeight:900,letterSpacing:"0.12em",textTransform:"uppercase",opacity:.7},children:"Description"}),(0,r.jsx)("textarea",{value:ee,onChange:e=>ec(e.target.value),placeholder:"What this project does…",rows:3,className:"scrollbar-thin",style:{borderRadius:12,border:"1px solid rgba(255,255,255,0.12)",background:"rgba(255,255,255,0.05)",color:"rgba(255,255,255,0.90)",padding:"10px 12px",outline:"none",resize:"vertical"}})]}),(0,r.jsx)("div",{style:{fontSize:12,color:"rgba(255,255,255,0.55)",lineHeight:1.4},children:"Autosave is enabled. Generated projects must include the Nexus Apex footer."})]})})]}),t&&m.length>0&&(0,r.jsx)(rl,{$open:eI,children:eI?(0,r.jsxs)(rc,{children:[(0,r.jsxs)(rd,{type:"button",onClick:()=>eZ(!1),"aria-label":"Collapse plan",children:[(0,r.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[(0,r.jsx)(g.Z,{size:16}),"Plan"]}),(0,r.jsx)("span",{style:{opacity:.7},children:"\xd7"})]}),(0,r.jsx)(rp,{children:(0,r.jsx)(nH,{items:m,currentStepId:h?e_:void 0,embedded:!0})})]}):(0,r.jsx)(rg,{type:"button",onClick:()=>eZ(!0),"aria-label":"Open plan",children:(0,r.jsx)(g.Z,{size:18})})}),(0,r.jsx)(nf,{visible:!0,open:ew,onToggle:()=>ev(e=>!e),health:eW,thought:b,status:em,error:q,logs:w,canFixResume:!1})]})]})},rF=n(5813),rz=n(9578);let rA=a.ZP.div.withConfig({componentId:"sc-2e3bb9a1-0"})(["width:100%;height:100%;display:grid;place-items:center;padding:18px;background:radial-gradient(900px 500px at 20% 10%,rgba(34,211,238,0.10),transparent 55%),radial-gradient(900px 500px at 80% 85%,rgba(168,85,247,0.10),transparent 55%),#0d1117;color:rgba(255,255,255,0.92);"]),rM=a.ZP.div.withConfig({componentId:"sc-2e3bb9a1-1"})(["width:min(760px,100%);border-radius:18px;border:1px solid rgba(255,255,255,0.14);background:rgba(255,255,255,0.05);backdrop-filter:blur(18px);box-shadow:0 30px 80px rgba(0,0,0,0.65),inset 0 1px 0 rgba(255,255,255,0.10);padding:16px;"]),rL=a.ZP.div.withConfig({componentId:"sc-2e3bb9a1-2"})(["display:flex;align-items:center;gap:10px;font-weight:900;letter-spacing:0.06em;text-transform:uppercase;font-size:12px;color:rgba(255,255,255,0.82);"]),rR=a.ZP.div.withConfig({componentId:"sc-2e3bb9a1-3"})(["margin-top:10px;font-size:13px;line-height:1.45;color:rgba(255,255,255,0.72);white-space:pre-wrap;"]),r$=a.ZP.div.withConfig({componentId:"sc-2e3bb9a1-4"})(["margin-top:14px;display:flex;gap:10px;flex-wrap:wrap;"]),rO=a.ZP.button.withConfig({componentId:"sc-2e3bb9a1-5"})(["height:40px;padding:0 14px;border-radius:14px;border:1px solid rgba(255,255,255,0.14);background:rgba(255,255,255,0.06);color:rgba(255,255,255,0.86);font-weight:800;letter-spacing:0.02em;display:inline-flex;align-items:center;gap:8px;cursor:pointer;&:hover{border-color:rgba(34,211,238,0.22);background:rgba(255,255,255,0.08);}"]);class rD extends i.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("UI Crash:",{message:e.message,stack:e.stack,componentStack:t.componentStack})}render(){var e;return this.state.hasError?this.props.fallback?this.props.fallback:(0,r.jsx)(rA,{children:(0,r.jsxs)(rM,{role:"alert","aria-live":"polite",children:[(0,r.jsxs)(rL,{children:[(0,r.jsx)(rF.Z,{size:18,color:"rgba(248,113,113,0.95)"}),"Something crashed"]}),(0,r.jsx)(rR,{children:(null===(e=this.state.error)||void 0===e?void 0:e.message)||"The UI encountered an error while rendering. You can try resetting the view or reloading the page."}),(0,r.jsxs)(r$,{children:[(0,r.jsxs)(rO,{type:"button",onClick:this.handleReset,children:[(0,r.jsx)(rz.Z,{size:16}),"Reset view"]}),(0,r.jsx)(rO,{type:"button",onClick:()=>window.location.reload(),children:"Reload"})]})]})}):this.props.children}constructor(...e){super(...e),(0,m._)(this,"state",{hasError:!1}),(0,m._)(this,"handleReset",()=>{var e,t;this.setState({hasError:!1,error:void 0}),null===(e=(t=this.props).onReset)||void 0===e||e.call(t)})}}var r_=n(6384);let rW=n(2949).env.NEXT_PUBLIC_CONVEX_URL;function rU(e){let{children:t}=e,n=(0,i.useMemo)(()=>rW?new r_.Zj(rW):null,[]);return n?(0,r.jsx)(r_.P9,{client:n,children:t}):(0,r.jsx)(r.Fragment,{children:t})}let rq=n(7698).qL,rH=!!n(2949).env.NEXT_PUBLIC_CONVEX_URL;function rG(){let[e,t]=(0,i.useState)(null),n=f(e=>e.setProjectName),r=f(e=>e.setProjectId),a=f(e=>e.setFiles),o=f(e=>e.setIsHydrating),s=f(e=>e.files),l=U(e=>e.isGenerating),c=(0,r_.Db)(rq.projects.ensureDefault),d=(0,r_.Db)(rq.files.upsert),p=(0,r_.aM)(rq.files.list,e?{projectId:e}:"skip"),g=(0,i.useRef)(!1),h=(0,i.useRef)(new Map),u=(0,i.useRef)(Promise.resolve()),x=(0,i.useMemo)(()=>p?p.map(e=>({name:e.path.split("/").pop()||e.path,path:e.path,content:e.content,language:void 0})):[],[p]);return(0,i.useEffect)(()=>{if(!rH)return;let e=!1;return(async()=>{o(!0);try{let i=await c({});if(e)return;let a=String((null==i?void 0:i.projectId)||"");t(a||null),r(a),"string"==typeof(null==i?void 0:i.name)&&n(i.name)}finally{e||o(!1)}})(),()=>{e=!0}},[c,o,r,n]),(0,i.useEffect)(()=>{if(rH&&e&&p){g.current=!0,o(!0);try{a(x),U.getState().setFilesFromProjectFiles(x);let e=new Map;for(let t of x){let n=t.path||t.name;n&&e.set(n,t.content||"")}h.current=e}finally{g.current=!1,o(!1)}}},[e,x,p,a,o]),(0,i.useEffect)(()=>{if(!rH||!e||g.current||l)return;let t=[];for(let e of s){let n=e.path||e.name;if(!n)continue;let r=e.content||"";h.current.get(n)!==r&&t.push({path:n,content:r})}if(0!==t.length)for(let n of t)h.current.set(n.path,n.content),u.current=u.current.then(async()=>{await d({projectId:e,path:n.path,content:n.content})})},[l,s,e,d]),null}function rB(){return rH?(0,r.jsx)(rG,{}):null}function rX(){return(0,r.jsx)(rD,{children:(0,r.jsxs)(rU,{children:[(0,r.jsx)(rB,{}),(0,r.jsx)(eG,{children:(0,r.jsx)(rN,{})})]})})}}},function(e){e.O(0,[610,290,554,115,364,744],function(){return e(e.s=678)}),_N_E=e.O()}]);